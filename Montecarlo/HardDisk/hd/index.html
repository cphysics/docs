<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Hard Disk - Computational Physics</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Hard Disk";
    var mkdocs_page_input_path = "Montecarlo/HardDisk/hd.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Computational Physics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../WhyComputationalPhysics/">Why Computational Physics</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Getting started</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/anaconda/">Guide to starting Python</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/lib/">Guide to Python Libraries</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/env/">Setting up Python Environment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/jupyter/">Installing Jupyter Notebook</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/git/">How to Git</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Python</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/ds/">Data Structure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/lnc/">Loops and Conditions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/fnc/">Function and Class</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Numerical Methods</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/intro/Numerical-Methods/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/special-function/Special-Functions/">Special Functions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Diffusion/Diffusion/">Diffusion</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Ncharges/Ncharges/">Ncharges</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Laplace/laplace/">Laplace</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Monte Carlo Simulation</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../GettingStarted/intro/">Getting Started Monte Carlo Simulation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../GettingStarted/intro/">Algorithms in Monte Carlo Simulation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../RandomWalk/Rwalk/">Random Walk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Lotto/lotto/">Lottary Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IdealGas/IdealGas/">Ideal Gas</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Oscillator/Oscillator/">Harmonic Oscillator</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IzingModel/Izing2D/">Ising Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Percolation/percol/">Percolation</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Hard Disk
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#from-classical-to-statistical-mechanics">
      From Classical to Statistical Mechanics
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#molecular-dynamics-of-hard-disk">Molecular Dynamics of Hard Disk</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#tutorial">TUTORIAL</a>
        </li>
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Levy/levy/">Quantum Monte Carlo</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BEC/bec/">Bose-Einstein Condensation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Optimization</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/intro/Optimization/">Optimization</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/SimulatedAnealing/simulatedAnn/">Simulated Annealing</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Path Integral</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../PathIntegral/Intro/Intro/">Getting Started with Path Integral</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Fractals and Chaos</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../FractalChaos/Fern/fern/">Fern</a>
  </li>
        
      </ul>
    </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../References/">References</a>
  </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Computational Physics</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Monte Carlo Simulation &raquo;</li>
        
      
    
    <li>Hard Disk</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="from-classical-to-statistical-mechanics">From Classical to Statistical Mechanics</h1>
<hr />
<h3 id="molecular-dynamics-of-hard-disk">Molecular Dynamics of Hard Disk</h3>
<ul>
<li>Direct Disc Box</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span>

N <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.2</span>
condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
<span style="color: #006699; font-weight: bold">while</span> condition <span style="color: #555555">==</span> <span style="color: #336666">False</span>:
    L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))]
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>, N):
        a <span style="color: #555555">=</span> (random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))
        min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>(math<span style="color: #555555">.</span>sqrt((a[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (a[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>) <span style="color: #006699; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> L) 
        <span style="color: #006699; font-weight: bold">if</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">2.0</span> <span style="color: #555555">*</span> sigma: 
            condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
            <span style="color: #006699; font-weight: bold">break</span>
        <span style="color: #006699; font-weight: bold">else</span>:
            L<span style="color: #555555">.</span>append(a)
            condition <span style="color: #555555">=</span> <span style="color: #336666">True</span>
<span style="color: #006699; font-weight: bold">print</span> L
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[(0.7040822912665547, 0.2838326710047917), (0.39342373803132735, 0.7421281133983488), (0.22142950612928214, 0.3458410218455974), (0.7925829007636611, 0.7013410752456171)]
</pre></div>


<ul>
<li>Direct Disk Box Multirun</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">direct_disks_box</span>(N, sigma):
    condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
    <span style="color: #006699; font-weight: bold">while</span> condition <span style="color: #555555">==</span> <span style="color: #336666">False</span>:
        L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>, N):
            a <span style="color: #555555">=</span> (random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))
            min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>(math<span style="color: #555555">.</span>sqrt((a[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (a[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>) <span style="color: #006699; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> L) 
            <span style="color: #006699; font-weight: bold">if</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">2.0</span> <span style="color: #555555">*</span> sigma: 
                condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
                <span style="color: #006699; font-weight: bold">break</span>
            <span style="color: #006699; font-weight: bold">else</span>:
                L<span style="color: #555555">.</span>append(a)
                condition <span style="color: #555555">=</span> <span style="color: #336666">True</span>
    <span style="color: #006699; font-weight: bold">return</span> L

N <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.2</span>
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    <span style="color: #006699; font-weight: bold">print</span> run, direct_disks_box(N, sigma)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>0 [(0.751356313701969, 0.7908289343521684), (0.24313895825655835, 0.7973141414323697), (0.7507021517199071, 0.2714537639453098), (0.3426034108818664, 0.25674882938107063)]
1 [(0.7001130563019435, 0.712536202933747), (0.7789122711097405, 0.21613491258078213), (0.26983653980009353, 0.2199783600278326), (0.25072808927037593, 0.6851623784867935)]
2 [(0.27105063881736857, 0.6886358310439302), (0.7644440210934729, 0.284338623092072), (0.7010507662892869, 0.6836895516220605), (0.26760130925261805, 0.2011960174940446)]
3 [(0.7117322082996034, 0.7923158146795577), (0.20576363915920695, 0.33938157321671625), (0.6867409813215277, 0.3649824434229453), (0.2923911189377729, 0.7825731272388934)]
4 [(0.6574676789386877, 0.6868976023198012), (0.2380039193149221, 0.21289805532217043), (0.7500703097734738, 0.2596580338864641), (0.2526218011018484, 0.6277752777754828)]
5 [(0.7644607478477052, 0.7887798072013239), (0.3913939422967541, 0.6150405110722064), (0.791845121739368, 0.37567457535107485), (0.27690058656665545, 0.22580973987400982)]
6 [(0.7883698163715596, 0.3078375245763364), (0.20119330613086495, 0.6697044533868605), (0.2766166755457118, 0.22309290996928166), (0.6054862825572884, 0.7994464708554057)]
7 [(0.389813730050234, 0.7708075320063368), (0.6868787305435617, 0.2611610652253845), (0.2654758128109487, 0.24841543305461442), (0.7983355323897738, 0.7423829503625712)]
8 [(0.339797971819223, 0.7785840995102176), (0.22143753469214858, 0.23470027601609306), (0.7785801571980291, 0.774135930262885), (0.7506325168837178, 0.2827089622089741)]
9 [(0.24318601622049738, 0.3458768932480638), (0.2964140949544102, 0.7758479941402523), (0.6929994951070302, 0.2861686259992965), (0.7290840925214166, 0.7150475327560442)]
</pre></div>


<ul>
<li>Direct Disk Box Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #555555">%</span>matplotlib inline
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">os</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span>

output_dir <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;direct_disks_box_movie&#39;</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">direct_disks_box</span>(N, sigma):
    condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
    <span style="color: #006699; font-weight: bold">while</span> condition <span style="color: #555555">==</span> <span style="color: #336666">False</span>:
        L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>, N):
            a <span style="color: #555555">=</span> (random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma))
            min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>(math<span style="color: #555555">.</span>sqrt((a[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (a[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>) <span style="color: #006699; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> L) 
            <span style="color: #006699; font-weight: bold">if</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">2.0</span> <span style="color: #555555">*</span> sigma: 
                condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
                <span style="color: #006699; font-weight: bold">break</span>
            <span style="color: #006699; font-weight: bold">else</span>:
                L<span style="color: #555555">.</span>append(a)
                condition <span style="color: #555555">=</span> <span style="color: #336666">True</span>
    <span style="color: #006699; font-weight: bold">return</span> L

img <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>exists(output_dir): os<span style="color: #555555">.</span>makedirs(output_dir)

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">snapshot</span>(pos, colors):
    <span style="color: #006699; font-weight: bold">global</span> img
    pylab<span style="color: #555555">.</span>subplots_adjust(left<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>, right<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, top<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, bottom<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>)
    pylab<span style="color: #555555">.</span>gcf()<span style="color: #555555">.</span>set_size_inches(<span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>)
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    pylab<span style="color: #555555">.</span>setp(pylab<span style="color: #555555">.</span>gca(), xticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], yticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    <span style="color: #006699; font-weight: bold">for</span> (x, y), c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">zip</span>(pos, colors):
        circle <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle((x, y), radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span>c)
        pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(circle)
    <span style="color: #0099FF; font-style: italic">#pylab.savefig(os.path.join(output_dir, &#39;%d.png&#39; % img), transparent=True)</span>
    <span style="color: #0099FF; font-style: italic">#pylab.close()</span>
    pylab<span style="color: #555555">.</span>show()
    img <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>

N <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
colors <span style="color: #555555">=</span> [<span style="color: #CC3300">&#39;r&#39;</span>, <span style="color: #CC3300">&#39;b&#39;</span>, <span style="color: #CC3300">&#39;g&#39;</span>, <span style="color: #CC3300">&#39;orange&#39;</span>]
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.2</span>
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    pos <span style="color: #555555">=</span> direct_disks_box(N, sigma)
    snapshot(pos, colors)
</pre></div>


<p><img alt="png" src="../output_9_0.png" /></p>
<p><img alt="png" src="../output_9_1.png" /></p>
<p><img alt="png" src="../output_9_2.png" /></p>
<p><img alt="png" src="../output_9_3.png" /></p>
<ul>
<li>Marcov Disk Box </li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>

L <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.75</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.75</span>]]
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.15</span>
sigma_sq <span style="color: #555555">=</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
delta <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>
n_steps <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
<span style="color: #006699; font-weight: bold">for</span> steps <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_steps):
    a <span style="color: #555555">=</span> random<span style="color: #555555">.</span>choice(L)
    b <span style="color: #555555">=</span> [a[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta), a[<span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta)]
    min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>((b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> c[<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> c[<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #006699; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> L <span style="color: #006699; font-weight: bold">if</span> c <span style="color: #555555">!=</span> a)
    box_cond <span style="color: #555555">=</span> <span style="color: #336666">min</span>(b[<span style="color: #FF6600">0</span>], b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">&lt;</span> sigma <span style="color: #000000; font-weight: bold">or</span> <span style="color: #336666">max</span>(b[<span style="color: #FF6600">0</span>], b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma
    <span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> (box_cond <span style="color: #000000; font-weight: bold">or</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>):
        a[:] <span style="color: #555555">=</span> b
<span style="color: #006699; font-weight: bold">print</span> L
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[[0.45422994214163115, 0.3713914635605748], [0.7844238520523379, 0.4224856102112645], [0.15518208223429647, 0.5396419610447033], [0.7314291546873124, 0.842673491596291]]
</pre></div>


<ul>
<li>Marcove Disk Box Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">os</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span>

output_dir <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;markov_disks_box_movie&#39;</span>

img <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>exists(output_dir): os<span style="color: #555555">.</span>makedirs(output_dir)
<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">snapshot</span>(pos, colors):
    <span style="color: #006699; font-weight: bold">global</span> img
    pylab<span style="color: #555555">.</span>subplots_adjust(left<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>, right<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, top<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, bottom<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>)
    pylab<span style="color: #555555">.</span>gcf()<span style="color: #555555">.</span>set_size_inches(<span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>)
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    pylab<span style="color: #555555">.</span>setp(pylab<span style="color: #555555">.</span>gca(), xticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], yticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    <span style="color: #006699; font-weight: bold">for</span> (x, y), c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">zip</span>(pos, colors):
        circle <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle((x, y), radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span>c)
        pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(circle)
    <span style="color: #0099FF; font-style: italic">#pylab.savefig(os.path.join(output_dir, &#39;%d.png&#39; % img), transparent=True)</span>
    <span style="color: #0099FF; font-style: italic">#pylab.close()</span>
    pylab<span style="color: #555555">.</span>show()
    img <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>

L <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.75</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.75</span>]]
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.15</span>
sigma_sq <span style="color: #555555">=</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
delta <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>
colors <span style="color: #555555">=</span> [<span style="color: #CC3300">&#39;r&#39;</span>, <span style="color: #CC3300">&#39;b&#39;</span>, <span style="color: #CC3300">&#39;g&#39;</span>, <span style="color: #CC3300">&#39;orange&#39;</span>]
n_steps <span style="color: #555555">=</span> <span style="color: #FF6600">5</span>
<span style="color: #006699; font-weight: bold">for</span> step <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_steps):
    snapshot(L, colors)
    a <span style="color: #555555">=</span> random<span style="color: #555555">.</span>choice(L)
    b <span style="color: #555555">=</span> [a[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta), a[<span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta)]
    min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>((b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> c[<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> c[<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #006699; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> L <span style="color: #006699; font-weight: bold">if</span> c <span style="color: #555555">!=</span> a) 
    box_cond <span style="color: #555555">=</span> <span style="color: #336666">min</span>(b[<span style="color: #FF6600">0</span>], b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">&lt;</span> sigma <span style="color: #000000; font-weight: bold">or</span> <span style="color: #336666">max</span>(b[<span style="color: #FF6600">0</span>], b[<span style="color: #FF6600">1</span>]) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma
    <span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> (box_cond <span style="color: #000000; font-weight: bold">or</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>):
        a[:] <span style="color: #555555">=</span> b
</pre></div>


<p><img alt="png" src="../output_13_0.png" /></p>
<p><img alt="png" src="../output_13_1.png" /></p>
<p><img alt="png" src="../output_13_2.png" /></p>
<p><img alt="png" src="../output_13_3.png" /></p>
<p><img alt="png" src="../output_13_4.png" /></p>
<ul>
<li>Event Disk Box </li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">math</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">wall_time</span>(pos_a, vel_a, sigma):
    <span style="color: #006699; font-weight: bold">if</span> vel_a <span style="color: #555555">&gt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> (<span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma <span style="color: #555555">-</span> pos_a) <span style="color: #555555">/</span> vel_a
    <span style="color: #006699; font-weight: bold">elif</span> vel_a <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> (pos_a <span style="color: #555555">-</span> sigma) <span style="color: #555555">/</span> <span style="color: #336666">abs</span>(vel_a)
    <span style="color: #006699; font-weight: bold">else</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #336666">float</span>(<span style="color: #CC3300">&#39;inf&#39;</span>)
    <span style="color: #006699; font-weight: bold">return</span> del_t

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">pair_time</span>(pos_a, vel_a, pos_b, vel_b, sigma):
    del_x <span style="color: #555555">=</span> [pos_b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> pos_a[<span style="color: #FF6600">0</span>], pos_b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> pos_a[<span style="color: #FF6600">1</span>]]
    del_x_sq <span style="color: #555555">=</span> del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_x[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
    del_v <span style="color: #555555">=</span> [vel_b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> vel_a[<span style="color: #FF6600">0</span>], vel_b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> vel_a[<span style="color: #FF6600">1</span>]]
    del_v_sq <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
    scal <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">*</span> del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">*</span> del_x[<span style="color: #FF6600">1</span>]
    Upsilon <span style="color: #555555">=</span> scal <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">-</span> del_v_sq <span style="color: #555555">*</span> ( del_x_sq <span style="color: #555555">-</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> sigma <span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">if</span> Upsilon <span style="color: #555555">&gt;</span> <span style="color: #FF6600">0.0</span> <span style="color: #000000; font-weight: bold">and</span> scal <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #555555">-</span> (scal <span style="color: #555555">+</span> math<span style="color: #555555">.</span>sqrt(Upsilon)) <span style="color: #555555">/</span> del_v_sq
    <span style="color: #006699; font-weight: bold">else</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #336666">float</span>(<span style="color: #CC3300">&#39;inf&#39;</span>)
    <span style="color: #006699; font-weight: bold">return</span> del_t

pos <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.75</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.75</span>]]
vel <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.21</span>, <span style="color: #FF6600">0.12</span>], [<span style="color: #FF6600">0.71</span>, <span style="color: #FF6600">0.18</span>], [<span style="color: #555555">-</span><span style="color: #FF6600">0.23</span>, <span style="color: #555555">-</span><span style="color: #FF6600">0.79</span>], [<span style="color: #FF6600">0.78</span>, <span style="color: #FF6600">0.1177</span>]]
singles <span style="color: #555555">=</span> [(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>)]
pairs <span style="color: #555555">=</span> [(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">2</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>)]
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.15</span>
t <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
n_events <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
<span style="color: #006699; font-weight: bold">for</span> event <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_events):
    wall_times <span style="color: #555555">=</span> [wall_time(pos[k][l], vel[k][l], sigma) <span style="color: #006699; font-weight: bold">for</span> k, l  <span style="color: #000000; font-weight: bold">in</span> singles]
    pair_times <span style="color: #555555">=</span> [pair_time(pos[k], vel[k], pos[l], vel[l], sigma) <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> pairs]
    next_event <span style="color: #555555">=</span> <span style="color: #336666">min</span>(wall_times <span style="color: #555555">+</span> pair_times)
    t <span style="color: #555555">+=</span> next_event
    <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> singles: pos[k][l] <span style="color: #555555">+=</span> vel[k][l] <span style="color: #555555">*</span> next_event 
    <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">min</span>(wall_times) <span style="color: #555555">&lt;</span> <span style="color: #336666">min</span>(pair_times):
        collision_disk, direction <span style="color: #555555">=</span> singles[wall_times<span style="color: #555555">.</span>index(next_event)]
        vel[collision_disk][direction] <span style="color: #555555">*=</span> <span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>
    <span style="color: #006699; font-weight: bold">else</span>: 
        a, b <span style="color: #555555">=</span> pairs[pair_times<span style="color: #555555">.</span>index(next_event)]
        del_x <span style="color: #555555">=</span> [pos[b][<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> pos[a][<span style="color: #FF6600">0</span>], pos[b][<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> pos[a][<span style="color: #FF6600">1</span>]]
        abs_x <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_x[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>)
        e_perp <span style="color: #555555">=</span> [c <span style="color: #555555">/</span> abs_x <span style="color: #006699; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> del_x]
        del_v <span style="color: #555555">=</span> [vel[b][<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> vel[a][<span style="color: #FF6600">0</span>], vel[b][<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> vel[a][<span style="color: #FF6600">1</span>]]
        scal <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">*</span> e_perp[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">*</span> e_perp[<span style="color: #FF6600">1</span>]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>): 
            vel[a][k] <span style="color: #555555">+=</span> e_perp[k] <span style="color: #555555">*</span> scal 
            vel[b][k] <span style="color: #555555">-=</span> e_perp[k] <span style="color: #555555">*</span> scal 
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;event&#39;</span>, event
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;time&#39;</span>, t
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;pos&#39;</span>, pos
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;vel&#39;</span>, vel
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>event 0
time 0.128205128205
pos [[0.27692307692307694, 0.2653846153846154], [0.841025641025641, 0.27307692307692305], [0.2205128205128205, 0.6487179487179487], [0.85, 0.7650897435897436]]
vel [[0.21, 0.12], [0.71, 0.18], [-0.23, -0.79], [-0.78, 0.1177]]
event 1
time 0.140845070423
pos [[0.2795774647887324, 0.2669014084507042], [0.85, 0.2753521126760563], [0.21760563380281692, 0.6387323943661972], [0.8401408450704225, 0.7665774647887323]]
vel [[0.21, 0.12], [-0.71, 0.18], [-0.23, -0.79], [-0.78, 0.1177]]
event 2
time 0.241075114766
pos [[0.30062577410096064, 0.2789290137719775], [0.7788366685157999, 0.2933935206579662], [0.19455272360370984, 0.5595506593344816], [0.7619614104821464, 0.7783745410080145]]
vel [[0.4559640224861213, -0.5307103210067202], [-0.71, 0.18], [-0.4759640224861213, -0.13928967899327982], [-0.78, 0.1177]]
event 3
time 0.334680348563
pos [[0.34330639302873317, 0.229251750095734], [0.7123769525200255, 0.31024246274140194], [0.15, 0.5465124163668252], [0.6889493281205914, 0.7893918770259055]]
vel [[0.4559640224861213, -0.5307103210067202], [-0.71, 0.18], [0.4759640224861213, -0.13928967899327982], [-0.78, 0.1177]]
event 4
time 0.426596320324
pos [[0.38521676924328674, 0.18047099521717305], [0.6471166125702025, 0.3267873376582585], [0.19374869564975986, 0.5337094701659757], [0.6172548701475463, 0.8002103869020945]]
vel [[-0.13004345387140676, -0.8580968115619534], [-0.12399252364247193, 0.5073864905552332], [0.4759640224861213, -0.13928967899327982], [-0.78, 0.1177]]
event 5
time 0.462106294031
pos [[0.38059892961546266, 0.15], [0.6427136413157146, 0.3448046185974856], [0.2106501655740237, 0.528763297327179], [0.5895570906555886, 0.8043899108074835]]
vel [[-0.13004345387140676, 0.8580968115619534], [-0.12399252364247193, 0.5073864905552332], [0.4759640224861213, -0.13928967899327982], [-0.78, 0.1177]]
event 6
time 0.56183325768
pos [[0.36763009081848935, 0.23557538953362597], [0.6303482434177226, 0.39540473269688253], [0.2581166123425427, 0.5148723605735898], [0.5117700590096738, 0.8161277744289247]]
vel [[0.2896767021129778, -0.21233369509579214], [-0.12399252364247193, 0.5073864905552332], [0.05624386650173674, 0.9311408276644657], [-0.78, 0.1177]]
event 7
time 0.642779758788
pos [[0.3910784063071447, 0.21838771984821145], [0.6203114824652683, 0.43647589381698054], [0.26266935654466417, 0.5902449526121742], [0.44863178814515003, 0.8256551776093791]]
vel [[0.2896767021129778, -0.21233369509579214], [-0.12399252364247193, 0.5073864905552332], [-0.6607492297641436, 0.023497791053664008], [-0.06300690373411966, 1.0253430366108016]]
event 8
time 0.666522858923
pos [[0.39795622925208957, 0.2133462596635909], [0.6173675155604766, 0.4485228220692043], [0.24698112141847836, 0.5908028630181046], [0.44713580892061633, 0.85]]
vel [[0.2896767021129778, -0.21233369509579214], [-0.12399252364247193, 0.5073864905552332], [-0.6607492297641436, 0.023497791053664008], [-0.06300690373411966, -1.0253430366108016]]
event 9
time 0.764669954349
pos [[0.4263871561770383, 0.19250632422888558], [0.6051980095104381, 0.4983213323755524], [0.1821305037122126, 0.5931091029589469], [0.4409518643273318, 0.7493655591414552]]
vel [[0.2896767021129778, -0.21233369509579214], [0.596499748925584, -0.5938596011324015], [-0.6607492297641436, 0.023497791053664008], [-0.7834991763021756, 0.07590305507683315]]
</pre></div>


<ul>
<li>Event Disk Box Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">os</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span>

output_dir <span style="color: #555555">=</span> <span style="color: #CC3300">&quot;event_disks_box_movie&quot;</span>
colors <span style="color: #555555">=</span> [<span style="color: #CC3300">&#39;r&#39;</span>, <span style="color: #CC3300">&#39;b&#39;</span>, <span style="color: #CC3300">&#39;g&#39;</span>, <span style="color: #CC3300">&#39;orange&#39;</span>]

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">wall_time</span>(pos_a, vel_a, sigma):
    <span style="color: #006699; font-weight: bold">if</span> vel_a <span style="color: #555555">&gt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> (<span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma <span style="color: #555555">-</span> pos_a) <span style="color: #555555">/</span> vel_a
    <span style="color: #006699; font-weight: bold">elif</span> vel_a <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> (pos_a <span style="color: #555555">-</span> sigma) <span style="color: #555555">/</span> <span style="color: #336666">abs</span>(vel_a)
    <span style="color: #006699; font-weight: bold">else</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #336666">float</span>(<span style="color: #CC3300">&#39;inf&#39;</span>)
    <span style="color: #006699; font-weight: bold">return</span> del_t

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">pair_time</span>(pos_a, vel_a, pos_b, vel_b, sigma):
    del_x <span style="color: #555555">=</span> [pos_b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> pos_a[<span style="color: #FF6600">0</span>], pos_b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> pos_a[<span style="color: #FF6600">1</span>]]
    del_x_sq <span style="color: #555555">=</span> del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_x[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
    del_v <span style="color: #555555">=</span> [vel_b[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> vel_a[<span style="color: #FF6600">0</span>], vel_b[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> vel_a[<span style="color: #FF6600">1</span>]]
    del_v_sq <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>
    scal <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">*</span> del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">*</span> del_x[<span style="color: #FF6600">1</span>]
    Upsilon <span style="color: #555555">=</span> scal <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">-</span> del_v_sq <span style="color: #555555">*</span> (del_x_sq <span style="color: #555555">-</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">if</span> Upsilon <span style="color: #555555">&gt;</span> <span style="color: #FF6600">0.0</span> <span style="color: #000000; font-weight: bold">and</span> scal <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0.0</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #555555">-</span> (scal <span style="color: #555555">+</span> math<span style="color: #555555">.</span>sqrt(Upsilon)) <span style="color: #555555">/</span> del_v_sq
    <span style="color: #006699; font-weight: bold">else</span>:
        del_t <span style="color: #555555">=</span> <span style="color: #336666">float</span>(<span style="color: #CC3300">&#39;inf&#39;</span>)
    <span style="color: #006699; font-weight: bold">return</span> del_t

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">min_arg</span>(l):
    <span style="color: #006699; font-weight: bold">return</span> <span style="color: #336666">min</span>(<span style="color: #336666">zip</span>(l, <span style="color: #336666">range</span>(<span style="color: #336666">len</span>(l))))

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">compute_next_event</span>(pos, vel):
    wall_times <span style="color: #555555">=</span> [wall_time(pos[k][l], vel[k][l], sigma) <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> singles]
    pair_times <span style="color: #555555">=</span> [pair_time(pos[k], vel[k], pos[l], vel[l], sigma) <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> pairs]
    <span style="color: #006699; font-weight: bold">return</span> min_arg(wall_times <span style="color: #555555">+</span> pair_times)

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">compute_new_velocities</span>(pos, vel, next_event_arg):
    <span style="color: #006699; font-weight: bold">if</span> next_event_arg <span style="color: #555555">&lt;</span> <span style="color: #336666">len</span>(singles):
        collision_disk, direction <span style="color: #555555">=</span> singles[next_event_arg]
        vel[collision_disk][direction] <span style="color: #555555">*=</span> <span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>
    <span style="color: #006699; font-weight: bold">else</span>:
        a, b <span style="color: #555555">=</span> pairs[next_event_arg <span style="color: #555555">-</span> <span style="color: #336666">len</span>(singles)]
        del_x <span style="color: #555555">=</span> [pos[b][<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> pos[a][<span style="color: #FF6600">0</span>], pos[b][<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> pos[a][<span style="color: #FF6600">1</span>]]
        abs_x <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(del_x[<span style="color: #FF6600">0</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> del_x[<span style="color: #FF6600">1</span>] <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>)
        e_perp <span style="color: #555555">=</span> [c <span style="color: #555555">/</span> abs_x <span style="color: #006699; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> del_x]
        del_v <span style="color: #555555">=</span> [vel[b][<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> vel[a][<span style="color: #FF6600">0</span>], vel[b][<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> vel[a][<span style="color: #FF6600">1</span>]]
        scal <span style="color: #555555">=</span> del_v[<span style="color: #FF6600">0</span>] <span style="color: #555555">*</span> e_perp[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> del_v[<span style="color: #FF6600">1</span>] <span style="color: #555555">*</span> e_perp[<span style="color: #FF6600">1</span>]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            vel[a][k] <span style="color: #555555">+=</span> e_perp[k] <span style="color: #555555">*</span> scal
            vel[b][k] <span style="color: #555555">-=</span> e_perp[k] <span style="color: #555555">*</span> scal

pylab<span style="color: #555555">.</span>subplots_adjust(left<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>, right<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, top<span style="color: #555555">=</span><span style="color: #FF6600">0.90</span>, bottom<span style="color: #555555">=</span><span style="color: #FF6600">0.10</span>)
pylab<span style="color: #555555">.</span>gcf()<span style="color: #555555">.</span>set_size_inches(<span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>)
img <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>exists(output_dir): os<span style="color: #555555">.</span>makedirs(output_dir)
<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">snapshot</span>(t, pos, vel, colors, arrow_scale<span style="color: #555555">=.</span><span style="color: #FF6600">2</span>):
    <span style="color: #006699; font-weight: bold">global</span> img
    pylab<span style="color: #555555">.</span>cla()
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    pylab<span style="color: #555555">.</span>setp(pylab<span style="color: #555555">.</span>gca(), xticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], yticks<span style="color: #555555">=</span>[<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    <span style="color: #006699; font-weight: bold">for</span> (x, y), (dx, dy), c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">zip</span>(pos, vel, colors):
        dx <span style="color: #555555">*=</span> arrow_scale
        dy <span style="color: #555555">*=</span> arrow_scale
        circle <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle((x, y), radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span>c)
        pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(circle)
    pylab<span style="color: #555555">.</span>arrow( x, y, dx, dy, fc<span style="color: #555555">=</span><span style="color: #CC3300">&quot;k&quot;</span>, ec<span style="color: #555555">=</span><span style="color: #CC3300">&quot;k&quot;</span>, head_width<span style="color: #555555">=</span><span style="color: #FF6600">0.05</span>, head_length<span style="color: #555555">=</span><span style="color: #FF6600">0.05</span> )
    pylab<span style="color: #555555">.</span>text(<span style="color: #555555">.</span><span style="color: #FF6600">5</span>, <span style="color: #FF6600">1.03</span>, <span style="color: #CC3300">&#39;t = </span><span style="color: #AA0000">%.2f</span><span style="color: #CC3300">&#39;</span> <span style="color: #555555">%</span> t, ha<span style="color: #555555">=</span><span style="color: #CC3300">&#39;center&#39;</span>)
    pylab<span style="color: #555555">.</span>savefig(os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>join(output_dir, <span style="color: #CC3300">&#39;</span><span style="color: #AA0000">%d</span><span style="color: #CC3300">.png&#39;</span> <span style="color: #555555">%</span> img))
    img <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>

pos <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.25</span>], [<span style="color: #FF6600">0.25</span>, <span style="color: #FF6600">0.75</span>], [<span style="color: #FF6600">0.75</span>, <span style="color: #FF6600">0.75</span>]]
vel <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.21</span>, <span style="color: #FF6600">0.12</span>], [<span style="color: #FF6600">0.71</span>, <span style="color: #FF6600">0.18</span>], [<span style="color: #555555">-</span><span style="color: #FF6600">0.23</span>, <span style="color: #555555">-</span><span style="color: #FF6600">0.79</span>], [<span style="color: #FF6600">0.78</span>, <span style="color: #FF6600">0.1177</span>]]
singles <span style="color: #555555">=</span> [(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>), (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>)]
pairs <span style="color: #555555">=</span> [(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">2</span>), (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>), (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>), (<span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>)]
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.15</span>
t <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
dt <span style="color: #555555">=</span> <span style="color: #FF6600">0.02</span>     <span style="color: #0099FF; font-style: italic"># dt=0 corresponds to event-to-event animation</span>
n_steps <span style="color: #555555">=</span> <span style="color: #FF6600">5</span>
next_event, next_event_arg <span style="color: #555555">=</span> compute_next_event(pos, vel)
snapshot(t, pos, vel, colors)
<span style="color: #006699; font-weight: bold">for</span> step <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_steps):
    <span style="color: #006699; font-weight: bold">if</span> dt:
        next_t <span style="color: #555555">=</span> t <span style="color: #555555">+</span> dt
    <span style="color: #006699; font-weight: bold">else</span>:
        next_t <span style="color: #555555">=</span> t <span style="color: #555555">+</span> next_event
    <span style="color: #006699; font-weight: bold">while</span> t <span style="color: #555555">+</span> next_event <span style="color: #555555">&lt;=</span> next_t:
        t <span style="color: #555555">+=</span> next_event
        <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> singles: pos[k][l] <span style="color: #555555">+=</span> vel[k][l] <span style="color: #555555">*</span> next_event
        compute_new_velocities(pos, vel, next_event_arg)
        next_event, next_event_arg <span style="color: #555555">=</span> compute_next_event(pos, vel)
    remain_t <span style="color: #555555">=</span> next_t <span style="color: #555555">-</span> t
    <span style="color: #006699; font-weight: bold">for</span> k, l <span style="color: #000000; font-weight: bold">in</span> singles: pos[k][l] <span style="color: #555555">+=</span> vel[k][l] <span style="color: #555555">*</span> remain_t
    t <span style="color: #555555">+=</span> remain_t
    next_event <span style="color: #555555">-=</span> remain_t
    snapshot(t, pos, vel, colors)
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;time&#39;</span>,t

<span style="color: #006699; font-weight: bold">print</span>(<span style="color: #CC3300">&#39;Producing animation.gif using ImageMagick...&#39;</span>)
os<span style="color: #555555">.</span>system(<span style="color: #CC3300">&quot;convert -delay 1 -dispose Background +page &quot;</span> <span style="color: #555555">+</span> <span style="color: #336666">str</span>(output_dir)
          <span style="color: #555555">+</span> <span style="color: #CC3300">&quot;/*.png -loop 0 &quot;</span> <span style="color: #555555">+</span> <span style="color: #336666">str</span>(output_dir) <span style="color: #555555">+</span> <span style="color: #CC3300">&quot;/animation.gif&quot;</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>time 0.02
time 0.04
time 0.06
time 0.08
time 0.1
Producing animation.gif using ImageMagick...





32512
</pre></div>


<p><img alt="png" src="../output_17_2.png" /></p>
<h2 id="tutorial">TUTORIAL</h2>
<hr />
<ul>
<li>Direct Discrete </li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>

configurations <span style="color: #555555">=</span> {(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>): <span style="color: #CC3300">&#39;a&#39;</span>, (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;b&#39;</span>, (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;c&#39;</span>,
                  (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;d&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;e&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>): <span style="color: #CC3300">&#39;f&#39;</span>}
counts <span style="color: #555555">=</span> {<span style="color: #CC3300">&#39;a&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;b&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;c&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;d&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;e&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;f&#39;</span>: <span style="color: #FF6600">0</span>}
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    <span style="color: #006699; font-weight: bold">while</span> <span style="color: #336666">True</span>:
        red_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>)
        blue_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>)
        <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(red_rod <span style="color: #555555">-</span> blue_rod) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">2</span>: <span style="color: #006699; font-weight: bold">break</span>
    conf <span style="color: #555555">=</span> configurations[(red_rod, blue_rod)]
    counts[conf] <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">for</span> conf <span style="color: #000000; font-weight: bold">in</span> counts:
    <span style="color: #006699; font-weight: bold">print</span> conf, counts[conf] <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_runs)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>a 0.1606
c 0.1744
b 0.1651
e 0.1688
d 0.1666
f 0.1645
</pre></div>


<ul>
<li>Direct Disk Any</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>

configurations <span style="color: #555555">=</span> {(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>): <span style="color: #CC3300">&#39;a&#39;</span>, (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;b&#39;</span>, (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;c&#39;</span>, 
                  (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;d&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;e&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>): <span style="color: #CC3300">&#39;f&#39;</span>}
counts <span style="color: #555555">=</span> {<span style="color: #CC3300">&#39;a&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;b&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;c&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;d&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;e&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;f&#39;</span>: <span style="color: #FF6600">0</span>}
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    red_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)
    <span style="color: #006699; font-weight: bold">if</span> red_rod <span style="color: #555555">&gt;=</span> <span style="color: #FF6600">2</span>: red_rod <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">while</span> <span style="color: #336666">True</span>:
        blue_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>)
        <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(red_rod <span style="color: #555555">-</span> blue_rod) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">2</span>: <span style="color: #006699; font-weight: bold">break</span>
    conf <span style="color: #555555">=</span> configurations[(red_rod, blue_rod)]  
    counts[conf] <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">for</span> conf <span style="color: #000000; font-weight: bold">in</span> counts: 
    <span style="color: #006699; font-weight: bold">print</span> conf, counts[conf] <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_runs)    
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>a 0.125
c 0.2535
b 0.1282
e 0.1236
d 0.2448
f 0.1249
</pre></div>


<ul>
<li>Direct Disk Slow</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>

N <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.2</span>
pairs <span style="color: #555555">=</span> [(i, j) <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N <span style="color: #555555">-</span> <span style="color: #FF6600">1</span>) <span style="color: #006699; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(i <span style="color: #555555">+</span> <span style="color: #FF6600">1</span>, N)]
<span style="color: #006699; font-weight: bold">while</span> <span style="color: #336666">True</span>:
    L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma), random<span style="color: #555555">.</span>uniform(sigma, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> sigma)) <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N)]
    <span style="color: #006699; font-weight: bold">if</span>  <span style="color: #336666">min</span>((L[i][<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> L[j][<span style="color: #FF6600">0</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (L[i][<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> L[j][<span style="color: #FF6600">1</span>]) <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #006699; font-weight: bold">for</span> i, j <span style="color: #000000; font-weight: bold">in</span> pairs) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> sigma <span style="color: #555555">**</span> <span style="color: #FF6600">2</span>: 
        <span style="color: #006699; font-weight: bold">break</span>
<span style="color: #006699; font-weight: bold">print</span> L
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[(0.21551840405127012, 0.6946062982572399), (0.7165001545926342, 0.7818232246535084), (0.23604717555981464, 0.20175467827936644), (0.7369665863408736, 0.22746836079162713)]
</pre></div>


<ul>
<li>Direct Disk Multy Run</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">dist</span>(x,y):
    d_x <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> y[<span style="color: #FF6600">0</span>]) <span style="color: #555555">%</span> <span style="color: #FF6600">1.0</span>
    d_x <span style="color: #555555">=</span> <span style="color: #336666">min</span>(d_x, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> d_x)
    d_y <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> y[<span style="color: #FF6600">1</span>]) <span style="color: #555555">%</span> <span style="color: #FF6600">1.0</span>
    d_y <span style="color: #555555">=</span> <span style="color: #336666">min</span>(d_y, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> d_y)
    <span style="color: #006699; font-weight: bold">return</span>  math<span style="color: #555555">.</span>sqrt(d_x<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> d_y<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">direct_disks</span>(N, sigma):
    n_iter <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
    <span style="color: #006699; font-weight: bold">while</span> condition <span style="color: #555555">==</span> <span style="color: #336666">False</span>:
        n_iter <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
        L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>random(), random<span style="color: #555555">.</span>random())]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>, N):
            a <span style="color: #555555">=</span> (random<span style="color: #555555">.</span>random(), random<span style="color: #555555">.</span>random())
            min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>(dist(a, b) <span style="color: #006699; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> L) 
            <span style="color: #006699; font-weight: bold">if</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">2.0</span> <span style="color: #555555">*</span> sigma: 
                condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
                <span style="color: #006699; font-weight: bold">break</span>
            <span style="color: #006699; font-weight: bold">else</span>:
                L<span style="color: #555555">.</span>append(a)
                condition <span style="color: #555555">=</span> <span style="color: #336666">True</span>
    <span style="color: #006699; font-weight: bold">return</span> n_iter, L

N <span style="color: #555555">=</span> <span style="color: #FF6600">16</span>
eta <span style="color: #555555">=</span> <span style="color: #FF6600">0.26</span>
sigma <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(eta <span style="color: #555555">/</span> N <span style="color: #555555">/</span> math<span style="color: #555555">.</span>pi)
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">3</span>
<span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;Note that this program might take a while!&#39;</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    iterations, config <span style="color: #555555">=</span>  direct_disks(N, sigma)
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;run&#39;</span>,run
    <span style="color: #006699; font-weight: bold">print</span> iterations <span style="color: #555555">-</span> <span style="color: #FF6600">1</span>, <span style="color: #CC3300">&#39;tabula rasa wipe-outs before producing the following configuration&#39;</span>
    <span style="color: #006699; font-weight: bold">print</span> config
    <span style="color: #006699; font-weight: bold">print</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Note that this program might take a while!
run 0
31605 tabula rasa wipe-outs before producing the following configuration
[(0.194889385979373, 0.39881902164303773), (0.2422007285687603, 0.7366374459128198), (0.35318282136090084, 0.5379884266619391), (0.5010455241583772, 0.4351768931362382), (0.6651055976532885, 0.4638578576617244), (0.9930426536472047, 0.4807095480519158), (0.17504742382982807, 0.10058142284791849), (0.055224973814334, 0.8728958780045791), (0.8132249354226135, 0.976570654646086), (0.6479652398072496, 0.05414388830919192), (0.01589908172878507, 0.2662968574596569), (0.6838513187488974, 0.19681773278090198), (0.9368744315347303, 0.685040874598465), (0.6148616792388668, 0.8576188696976752), (0.38396787071111793, 0.9725957113091733), (0.7881129382924161, 0.6785640836009906)]

run 1
15954 tabula rasa wipe-outs before producing the following configuration
[(0.4314049494382257, 0.6098720262344923), (0.017147469087248735, 0.04156012115642216), (0.36056156266147066, 0.848096088241863), (0.8125158065154952, 0.17366599388221793), (0.23732974230881831, 0.7494139151797977), (0.8348176875378838, 0.9989865343591413), (0.9598695317665644, 0.5346727546971781), (0.9745750478535258, 0.9026397096818709), (0.5788447208944535, 0.9892731652141654), (0.43368740080388346, 0.39188323415156523), (0.1026937138183539, 0.4900126255806251), (0.15313471644384324, 0.3225265326989947), (0.24881039713052955, 0.6005423814016275), (0.09841408880804847, 0.6398251433990972), (0.9254533880596515, 0.7439429279989943), (0.30040196508760963, 0.20692775996149626)]

run 2
52422 tabula rasa wipe-outs before producing the following configuration
[(0.5873980387542752, 0.03679282835548914), (0.11907075962976255, 0.44081971114056717), (0.9080215465908837, 0.671213015105709), (0.09022299677404289, 0.9507269787134838), (0.3001832219134687, 0.9687529174595204), (0.024158935597102804, 0.8117170627395138), (0.8457396014770665, 0.45224114982654495), (0.28763080699756904, 0.523078745591618), (0.8915709907417944, 0.1654529589377659), (0.205399596915937, 0.14035571179162276), (0.9776855981260978, 0.37045935309310907), (0.22316762060964956, 0.3302967536169472), (0.3872637064501423, 0.7600916230737015), (0.7138292384724666, 0.11545586820923892), (0.46404649182910096, 0.8999851793352671), (0.15322468771280318, 0.7070784377536645)]
</pre></div>


<ul>
<li>Direct Disk Multirun Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">math</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">os</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">dist</span>(x,y):
    d_x <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span> y[<span style="color: #FF6600">0</span>]) <span style="color: #555555">%</span> <span style="color: #FF6600">1.0</span>
    d_x <span style="color: #555555">=</span> <span style="color: #336666">min</span>(d_x, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> d_x)
    d_y <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> y[<span style="color: #FF6600">1</span>]) <span style="color: #555555">%</span> <span style="color: #FF6600">1.0</span>
    d_y <span style="color: #555555">=</span> <span style="color: #336666">min</span>(d_y, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> d_y)
    <span style="color: #006699; font-weight: bold">return</span>  math<span style="color: #555555">.</span>sqrt(d_x<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> d_y<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">direct_disks</span>(N, sigma):
    n_iter <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
    <span style="color: #006699; font-weight: bold">while</span> condition <span style="color: #555555">==</span> <span style="color: #336666">False</span>:
        n_iter <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
        L <span style="color: #555555">=</span> [(random<span style="color: #555555">.</span>random(), random<span style="color: #555555">.</span>random())]
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>, N):
            a <span style="color: #555555">=</span> (random<span style="color: #555555">.</span>random(), random<span style="color: #555555">.</span>random())
            min_dist <span style="color: #555555">=</span> <span style="color: #336666">min</span>(dist(a, b) <span style="color: #006699; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> L) 
            <span style="color: #006699; font-weight: bold">if</span> min_dist <span style="color: #555555">&lt;</span> <span style="color: #FF6600">2.0</span> <span style="color: #555555">*</span> sigma: 
                condition <span style="color: #555555">=</span> <span style="color: #336666">False</span>
                <span style="color: #006699; font-weight: bold">break</span>
            <span style="color: #006699; font-weight: bold">else</span>:
                L<span style="color: #555555">.</span>append(a)
                condition <span style="color: #555555">=</span> <span style="color: #336666">True</span>
    <span style="color: #006699; font-weight: bold">return</span> n_iter, L

img <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
output_dir <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;direct_disks_multirun_movie&#39;</span>
<span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>exists(output_dir): os<span style="color: #555555">.</span>makedirs(output_dir)
<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">snapshot</span>(pos, colors, border_color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;k&#39;</span>):
    <span style="color: #006699; font-weight: bold">global</span> img
    pylab<span style="color: #555555">.</span>figure()
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>])
    [i<span style="color: #555555">.</span>set_linewidth(<span style="color: #FF6600">2</span>) <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>spines<span style="color: #555555">.</span>itervalues()]
    [i<span style="color: #555555">.</span>set_color(border_color) <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>spines<span style="color: #555555">.</span>itervalues()]
    pylab<span style="color: #555555">.</span>setp(pylab<span style="color: #555555">.</span>gca(), xticks <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], yticks <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], aspect <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;equal&#39;</span>)
    <span style="color: #006699; font-weight: bold">for</span> (x, y), c <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">zip</span>(pos, colors):
        circle <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle((x, y), radius <span style="color: #555555">=</span> sigma, fc <span style="color: #555555">=</span> c)
        pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(circle)
    <span style="color: #0099FF; font-style: italic">#pylab.savefig(output_dir+&#39;/snapshot_%03i.png&#39;%img)</span>
    <span style="color: #0099FF; font-style: italic">#pylab.close()</span>
    pylab<span style="color: #555555">.</span>show()
    img <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">periodicize</span>(config):
    images <span style="color: #555555">=</span> [<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">0.0</span>, <span style="color: #FF6600">1.0</span>]
    <span style="color: #006699; font-weight: bold">return</span> [(x <span style="color: #555555">+</span> dx, y <span style="color: #555555">+</span> dy) <span style="color: #006699; font-weight: bold">for</span> (x,y) <span style="color: #000000; font-weight: bold">in</span> config <span style="color: #006699; font-weight: bold">for</span> dx <span style="color: #000000; font-weight: bold">in</span> images <span style="color: #006699; font-weight: bold">for</span> dy <span style="color: #000000; font-weight: bold">in</span> images]

N <span style="color: #555555">=</span> <span style="color: #FF6600">16</span>
eta <span style="color: #555555">=</span> <span style="color: #FF6600">0.28</span>
sigma <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(eta <span style="color: #555555">/</span> N <span style="color: #555555">/</span> math<span style="color: #555555">.</span>pi)
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
colors <span style="color: #555555">=</span> [<span style="color: #CC3300">&#39;r&#39;</span> <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">8</span> <span style="color: #555555">*</span> N)]
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    iterations, config <span style="color: #555555">=</span>  direct_disks(N, sigma)
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;run&#39;</span>,run
    <span style="color: #006699; font-weight: bold">print</span> iterations <span style="color: #555555">-</span> <span style="color: #FF6600">1</span>, <span style="color: #CC3300">&#39;tabula rasa wipe-outs before producing the following configuration&#39;</span>
    <span style="color: #006699; font-weight: bold">print</span> config
    <span style="color: #006699; font-weight: bold">print</span>
    config_per <span style="color: #555555">=</span> periodicize(config)
    snapshot(config_per, colors, border_color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;k&#39;</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>run 0
131155 tabula rasa wipe-outs before producing the following configuration
[(0.37751482770484623, 0.09826945819054489), (0.9042803838379859, 0.9899090068252806), (0.6599172275086992, 0.13514484949079997), (0.3069710953434255, 0.9492470432337818), (0.812561619375132, 0.40987724481013443), (0.08056164082415274, 0.9742623716403652), (0.17768767689521647, 0.36507790353189173), (0.7472387120689303, 0.6515254273168409), (0.4823057447690441, 0.966105763619611), (0.8439633788642334, 0.22358147605283396), (0.2773016015309173, 0.5814435581054298), (0.9889618140696187, 0.1438503101976658), (0.14326378711556154, 0.7477166886625792), (0.9583168761426655, 0.7453819253487872), (0.6958450554989644, 0.833667878473739), (0.03867224868418362, 0.45119012797766134)]
</pre></div>


<p><img alt="png" src="../output_29_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>run 1
151638 tabula rasa wipe-outs before producing the following configuration
[(0.06663014301020642, 0.031012554991157848), (0.964969664612716, 0.3118932568228565), (0.5264170452307265, 0.21975704506305127), (0.6756537746594122, 0.4041417433687611), (0.29476393772557075, 0.48140722828952787), (0.04654217216799017, 0.7996306905990145), (0.3608861327100239, 0.977618260879936), (0.6681113244137261, 0.6090611715960019), (0.12110126452367742, 0.22017356776253005), (0.8799686683355867, 0.6697177890430397), (0.5562558075938777, 0.010767930248896995), (0.47925142273497534, 0.6082991245007762), (0.8951272729365909, 0.868123465117719), (0.7441835171796956, 0.20179368489656824), (0.29000010977447666, 0.2067871038708291), (0.10233368264294007, 0.54745216577934)]
</pre></div>


<p><img alt="png" src="../output_29_3.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>run 2
40762 tabula rasa wipe-outs before producing the following configuration
[(0.3260865108779446, 0.3148486233563623), (0.17803174008736766, 0.871851631193864), (0.8642532654525102, 0.08718797467709805), (0.4535702388344728, 0.1972919882412194), (0.07246890805097073, 0.5355473801360247), (0.3167501018585722, 0.7681798596800488), (0.671929948288115, 0.08427537345070424), (0.8644955101334825, 0.41613572562559775), (0.9021147383601401, 0.23196647448286645), (0.1780243297944175, 0.07236748708775964), (0.9632055830413773, 0.920103872618813), (0.90024339362327, 0.6917231317784356), (0.6185771240906243, 0.5665103724765188), (0.6793688570302557, 0.7331932103505989), (0.5239912054538993, 0.9604405020823239), (0.07573035699193864, 0.21241500055444595)]
</pre></div>


<p><img alt="png" src="../output_29_5.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>run 3
1734 tabula rasa wipe-outs before producing the following configuration
[(0.2969684910325956, 0.7370119193950877), (0.9483844593486023, 0.6061018303643925), (0.1845637095681364, 0.11755918194051718), (0.9224199053841572, 0.869609425930199), (0.8519294493087842, 0.10902428512765583), (0.5101493777903654, 0.2872301781881832), (0.9875828733480082, 0.04180666162781088), (0.6831331006373645, 0.8465660961464345), (0.6993010504747139, 0.6378153765843604), (0.5672049317965627, 0.5350506678949322), (0.36850545523016154, 0.4642146828212168), (0.39988375455206737, 0.862433823125543), (0.7437881541243506, 0.3123760520673676), (0.6030356510965643, 0.10933875059004539), (0.9864351374492086, 0.2778717125787915), (0.16589795291507614, 0.5442153195383387)]
</pre></div>


<p><img alt="png" src="../output_29_7.png" /></p>
<ul>
<li>Random Sequential Discrete</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>

configurations <span style="color: #555555">=</span> {(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>): <span style="color: #CC3300">&#39;a&#39;</span>, (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;b&#39;</span>, (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;c&#39;</span>, 
                  (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;d&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;e&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>): <span style="color: #CC3300">&#39;f&#39;</span>}
counts <span style="color: #555555">=</span> {<span style="color: #CC3300">&#39;a&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;b&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;c&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;d&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;e&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;f&#39;</span>: <span style="color: #FF6600">0</span>}
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    red_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)
    <span style="color: #006699; font-weight: bold">if</span> red_rod <span style="color: #555555">&gt;=</span> <span style="color: #FF6600">2</span>: red_rod <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">while</span> <span style="color: #336666">True</span>:
        blue_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>)
        <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(red_rod <span style="color: #555555">-</span> blue_rod) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">2</span>: <span style="color: #006699; font-weight: bold">break</span>
    conf <span style="color: #555555">=</span> configurations[(red_rod, blue_rod)]  
    counts[conf] <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">for</span> conf <span style="color: #000000; font-weight: bold">in</span> counts: 
    <span style="color: #006699; font-weight: bold">print</span> conf, counts[conf] <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_runs)    
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>a 0.1281
c 0.2548
b 0.122
e 0.1238
d 0.2474
f 0.1239
</pre></div>


<ul>
<li>Random Sequential Discrete Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">os</span>

output_dir <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;random_sequential_discrete_movie&#39;</span>
<span style="color: #006699; font-weight: bold">if</span> <span style="color: #000000; font-weight: bold">not</span> os<span style="color: #555555">.</span>path<span style="color: #555555">.</span>exists(output_dir): os<span style="color: #555555">.</span>makedirs(output_dir)
<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">show_rods</span>(red_rod, blue_rod, run, trial, frame):
    fig, ax <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>subplots()
    ax<span style="color: #555555">.</span>set_xticks([<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">4</span>])
    ax<span style="color: #555555">.</span>set_yticks([])
    height <span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>
    redrect <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Rectangle((red_rod <span style="color: #555555">-</span> <span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">0.0</span>), <span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">1.1</span> <span style="color: #555555">*</span> height,  fc <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;r&#39;</span>)
    pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(redrect)
    bluerect <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Rectangle((blue_rod<span style="color: #555555">-</span><span style="color: #FF6600">1.5</span>,<span style="color: #FF6600">0.0</span>), <span style="color: #FF6600">3.0</span>, height,  fc <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(bluerect)
    pylab<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;scaled&#39;</span>)
    pylab<span style="color: #555555">.</span>axis([<span style="color: #555555">-</span><span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">5.5</span>, <span style="color: #FF6600">0.0</span>, <span style="color: #FF6600">2.5</span><span style="color: #555555">*</span>height])
    pylab<span style="color: #555555">.</span>xlabel(<span style="color: #CC3300">&quot;x&quot;</span>)
    <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(red_rod <span style="color: #555555">-</span> blue_rod) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">2</span>:
        pylab<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;run </span><span style="color: #AA0000">%d</span><span style="color: #CC3300">, trial </span><span style="color: #AA0000">%d</span><span style="color: #CC3300"> (ACCEPTED!)&#39;</span> <span style="color: #555555">%</span> (run, trial))
    <span style="color: #006699; font-weight: bold">else</span>:
        pylab<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;run </span><span style="color: #AA0000">%d</span><span style="color: #CC3300">, trial </span><span style="color: #AA0000">%d</span><span style="color: #CC3300"> (REJECTED!)&#39;</span> <span style="color: #555555">%</span> (run, trial))
    <span style="color: #0099FF; font-style: italic">#pylab.savefig(output_dir+&#39;/random_sequential_discrete_frame%d.png&#39; % (frame))</span>
    pylab<span style="color: #555555">.</span>show()

configurations <span style="color: #555555">=</span> {(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>): <span style="color: #CC3300">&#39;a&#39;</span>, (<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;b&#39;</span>, (<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>): <span style="color: #CC3300">&#39;c&#39;</span>, 
                  (<span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;d&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>): <span style="color: #CC3300">&#39;e&#39;</span>, (<span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>): <span style="color: #CC3300">&#39;f&#39;</span>}
counts <span style="color: #555555">=</span> {<span style="color: #CC3300">&#39;a&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;b&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;c&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;d&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;e&#39;</span>: <span style="color: #FF6600">0</span>, <span style="color: #CC3300">&#39;f&#39;</span>: <span style="color: #FF6600">0</span>}
n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">5</span>
frame <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
trial <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    red_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)
    <span style="color: #006699; font-weight: bold">if</span> red_rod <span style="color: #555555">&gt;=</span> <span style="color: #FF6600">2</span>: red_rod <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    trial <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    <span style="color: #006699; font-weight: bold">while</span> <span style="color: #336666">True</span>:
        blue_rod <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">4</span>)
        show_rods(red_rod, blue_rod, run, trial, frame)
        trial <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
        frame <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
        <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(red_rod <span style="color: #555555">-</span> blue_rod) <span style="color: #555555">&gt;</span> <span style="color: #FF6600">2</span>: <span style="color: #006699; font-weight: bold">break</span>
    conf <span style="color: #555555">=</span> configurations[(red_rod, blue_rod)]
    counts[conf] <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">for</span> conf <span style="color: #000000; font-weight: bold">in</span> counts:
    <span style="color: #006699; font-weight: bold">print</span> conf, counts[conf] <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_runs)
</pre></div>


<p><img alt="png" src="../output_33_0.png" /></p>
<p><img alt="png" src="../output_33_1.png" /></p>
<p><img alt="png" src="../output_33_2.png" /></p>
<p><img alt="png" src="../output_33_3.png" /></p>
<p><img alt="png" src="../output_33_4.png" /></p>
<p><img alt="png" src="../output_33_5.png" /></p>
<p><img alt="png" src="../output_33_6.png" /></p>
<p><img alt="png" src="../output_33_7.png" /></p>
<p><img alt="png" src="../output_33_8.png" /></p>
<p><img alt="png" src="../output_33_9.png" /></p>
<p><img alt="png" src="../output_33_10.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>a 0.4
c 0.2
b 0.0
e 0.2
d 0.2
f 0.0
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../Levy/levy/" class="btn btn-neutral float-right" title="Quantum Monte Carlo">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../Percolation/percol/" class="btn btn-neutral" title="Percolation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../Percolation/percol/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../Levy/levy/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
