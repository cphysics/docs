<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Algorithms in Monte Carlo Simulation - Computational Physics</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Algorithms in Monte Carlo Simulation";
    var mkdocs_page_input_path = "Montecarlo/GettingStarted/intro.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Computational Physics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../WhyComputationalPhysics/">Why Computational Physics</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Getting started</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/anaconda/">Guide to starting Python</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/lib/">Guide to Python Libraries</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/env/">Setting up Python Environment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/jupyter/">Installing Jupyter Notebook</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/git/">How to Git</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Python</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/ds/">Data Structure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/lnc/">Loops and Conditions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Python/fnc/">Function and Class</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Numerical Methods</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/intro/Numerical-Methods/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/special-function/Special-Functions/">Special Functions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Diffusion/Diffusion/">Diffusion</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Ncharges/Ncharges/">Ncharges</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Laplace/laplace/">Laplace</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Monte Carlo Simulation</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="./">Getting Started Monte Carlo Simulation</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Algorithms in Monte Carlo Simulation
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#introduction-to-montecarlo-method">
      Introduction to Montecarlo Method
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#lets-calculate-the-value-of-pi-directly">Lets calculate the value of PI directly</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#marcob-chain-calculation-of-pi">Marcob chain Calculation of PI</a>
        </li>
    
      
          

  <li class="toctree-l3">
    <a href="#pebble-game">
      Pebble Game
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#pebble-multirun">Pebble Multirun</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#peeble-dual">Peeble-Dual</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../RandomWalk/Rwalk/">Random Walk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Lotto/lotto/">Lottary Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IdealGas/IdealGas/">Ideal Gas</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Oscillator/Oscillator/">Harmonic Oscillator</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IzingModel/Izing2D/">Ising Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Percolation/percol/">Percolation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../HardDisk/hd/">Hard Disk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Levy/levy/">Quantum Monte Carlo</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BEC/bec/">Bose-Einstein Condensation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Optimization</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/intro/Optimization/">Optimization</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/SimulatedAnealing/simulatedAnn/">Simulated Annealing</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Path Integral</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../PathIntegral/Intro/Intro/">Getting Started with Path Integral</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Fractals and Chaos</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../FractalChaos/Fern/fern/">Fern</a>
  </li>
        
      </ul>
    </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../References/">References</a>
  </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Computational Physics</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Monte Carlo Simulation &raquo;</li>
        
      
    
    <li>Algorithms in Monte Carlo Simulation</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="introduction-to-montecarlo-method">Introduction to Montecarlo Method</h1>
<hr />
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">pylab</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
sns<span style="color: #555555">.</span>set()
<span style="color: #555555">%</span>matplotlib inline
</pre></div>


<h5 id="lets-calculate-the-value-of-pi-directly">Lets calculate the value of PI directly</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>n_trials <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
n_hits <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">8</span>,<span style="color: #FF6600">8</span>])
<span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_trials):
    x <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>)
    y <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>)
    <span style="color: #006699; font-weight: bold">if</span> x<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> y<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>: 
        plt<span style="color: #555555">.</span>scatter(x,y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&quot;blue&quot;</span>)
        n_hits <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">else</span>:
         plt<span style="color: #555555">.</span>scatter(x,y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&quot;red&quot;</span>)
<span style="color: #006699; font-weight: bold">print</span>(<span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> n_hits <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_trials))
plt<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&quot;test.png&quot;</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>3.208
</pre></div>


<p><img alt="png" src="../output_4_1.png" /></p>
<ul>
<li>Lets construct the function to run above code multiple time</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">direct_pi</span>(N):
    n_hits <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        x <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>)
        y <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>)
        <span style="color: #006699; font-weight: bold">if</span> x <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">+</span> y <span style="color: #555555">**</span> <span style="color: #FF6600">2</span> <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>:
            n_hits <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    computed_pi <span style="color: #555555">=</span> <span style="color: #FF6600">4.0</span><span style="color: #555555">*</span>n_hits <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_trials)        
    <span style="color: #006699; font-weight: bold">return</span> computed_pi
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
n_trials <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    pi <span style="color: #555555">=</span> direct_pi(n_trials) 
    plt<span style="color: #555555">.</span>scatter(run,pi)
</pre></div>


<p><img alt="png" src="../output_7_0.png" /></p>
<h4 id="marcob-chain-calculation-of-pi">Marcob chain Calculation of PI</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>x, y <span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>
delta <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>
n_trials <span style="color: #555555">=</span> <span style="color: #FF6600">5000</span>
n_hits <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_trials):
    del_x <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta)
    del_y <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta)

    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;to make sure they are inside square&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">if</span> (<span style="color: #336666">abs</span>(x <span style="color: #555555">+</span> del_x) <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #000000; font-weight: bold">and</span> <span style="color: #336666">abs</span>(y <span style="color: #555555">+</span> del_y) <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>):
        x <span style="color: #555555">=</span> x <span style="color: #555555">+</span> del_x
        y <span style="color: #555555">=</span> y <span style="color: #555555">+</span> del_y

    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;to make sure they are inside circle&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">if</span> x<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> y<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>:
        n_hits <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>  
        plt<span style="color: #555555">.</span>scatter(x,y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&quot;blue&quot;</span>)
    <span style="color: #006699; font-weight: bold">else</span>:
        plt<span style="color: #555555">.</span>scatter(x,y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&quot;red&quot;</span>)

<span style="color: #006699; font-weight: bold">print</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> n_hits <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_trials)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>3.0576
</pre></div>


<p><img alt="png" src="../output_9_1.png" /></p>
<ul>
<li>Lets construct the function to run above code multiple time.</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">markov_pi</span>(N, delta): 
    x, y <span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>
    n_hits <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        del_x, del_y <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta), random<span style="color: #555555">.</span>uniform(<span style="color: #555555">-</span>delta, delta)
        <span style="color: #006699; font-weight: bold">if</span> <span style="color: #336666">abs</span>(x <span style="color: #555555">+</span> del_x) <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #000000; font-weight: bold">and</span> <span style="color: #336666">abs</span>(y <span style="color: #555555">+</span> del_y) <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>:
            x, y <span style="color: #555555">=</span> x <span style="color: #555555">+</span> del_x, y <span style="color: #555555">+</span> del_y
        <span style="color: #006699; font-weight: bold">if</span> x<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> y<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>: n_hits <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
        computed_pi <span style="color: #555555">=</span> <span style="color: #FF6600">4.0</span> <span style="color: #555555">*</span> n_hits <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_trials)    
    <span style="color: #006699; font-weight: bold">return</span> computed_pi
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>n_runs <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
n_trials <span style="color: #555555">=</span> <span style="color: #FF6600">400</span>
delta <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_runs):
    pi <span style="color: #555555">=</span>  markov_pi(n_trials, delta)
    plt<span style="color: #555555">.</span>scatter(run,pi)
</pre></div>


<p><img alt="png" src="../output_12_0.png" /></p>
<hr />
<h2 id="pebble-game">Pebble Game</h2>
<hr />
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Lets Construct Pebble Story
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>neighbor <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">4</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">4</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>]]
t_max <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
site <span style="color: #555555">=</span> <span style="color: #FF6600">8</span>
t <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">print</span> site
<span style="color: #006699; font-weight: bold">while</span> t <span style="color: #555555">&lt;</span> t_max:
    t <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span>
    site <span style="color: #555555">=</span> neighbor[site][random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
    <span style="color: #006699; font-weight: bold">print</span> site
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>8
8
5
2
2
</pre></div>


<p>Histogram with weight</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>neighbor_o <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">4</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">4</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>]]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>histo <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>]
weight <span style="color: #555555">=</span> [<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">1.0</span>]
pos <span style="color: #555555">=</span> <span style="color: #FF6600">8</span>
n_iter <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
<span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n_iter):
    new_pos <span style="color: #555555">=</span> neighbor_o[pos][random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
    <span style="color: #006699; font-weight: bold">if</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">&lt;</span> weight[new_pos] <span style="color: #555555">/</span> weight[pos]:
        pos <span style="color: #555555">=</span> new_pos
    histo[pos] <span style="color: #555555">+=</span> <span style="color: #FF6600">1</span> 

norm <span style="color: #555555">=</span> <span style="color: #336666">sum</span>(weight)
<span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;comparison:  weight, histogram&#39;</span>
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>): 
    <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&#39;site: &#39;</span>, k,<span style="color: #CC3300">&#39; weight: &#39;</span>, weight[k], <span style="color: #CC3300">&#39; histo: &#39;</span>, norm <span style="color: #555555">*</span> histo[k] <span style="color: #555555">/</span> <span style="color: #336666">float</span>(n_iter)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>comparison:  weight, histogram
site:  0  weight:  3.0  histo:  2.952
site:  1  weight:  0.5  histo:  0.501
site:  2  weight:  1.0  histo:  0.975
site:  3  weight:  0.5  histo:  0.479
site:  4  weight:  1.0  histo:  1.001
site:  5  weight:  0.5  histo:  0.496
site:  6  weight:  2.0  histo:  2.121
site:  7  weight:  0.5  histo:  0.508
site:  8  weight:  1.0  histo:  0.967
</pre></div>


<h4 id="pebble-multirun">Pebble Multirun</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>neighbour <span style="color: #555555">=</span> {<span style="color: #FF6600">1</span> : [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">1</span>], <span style="color: #FF6600">2</span> : [<span style="color: #FF6600">3</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>], <span style="color: #FF6600">3</span> : [<span style="color: #FF6600">3</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>],
            <span style="color: #FF6600">4</span> : [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">1</span>], <span style="color: #FF6600">5</span> : [<span style="color: #FF6600">6</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>], <span style="color: #FF6600">6</span> : [<span style="color: #FF6600">6</span>, <span style="color: #FF6600">9</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">3</span>],
            <span style="color: #FF6600">7</span> : [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">4</span>], <span style="color: #FF6600">8</span> : [<span style="color: #FF6600">9</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>], <span style="color: #FF6600">9</span> : [<span style="color: #FF6600">9</span>, <span style="color: #FF6600">9</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">6</span>]}
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>xvec <span style="color: #555555">=</span> {<span style="color: #FF6600">1</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">5</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">6</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">7</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">8</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">9</span>:<span style="color: #FF6600">1</span>} 
yvec <span style="color: #555555">=</span> {<span style="color: #FF6600">1</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">6</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">7</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">8</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">9</span>:<span style="color: #FF6600">3</span>} 


list_vec <span style="color: #555555">=</span> []

run <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
<span style="color: #006699; font-weight: bold">if</span> run <span style="color: #555555">&lt;</span> <span style="color: #FF6600">10</span>: 
    run_str<span style="color: #555555">=</span> <span style="color: #CC3300">&#39;0&#39;</span> <span style="color: #555555">+</span> <span style="color: #336666">str</span>(run)
<span style="color: #006699; font-weight: bold">else</span>: 
    run_str <span style="color: #555555">=</span> <span style="color: #336666">str</span>(run)


<span style="color: #006699; font-weight: bold">for</span> n_runs <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">100000</span>): 
    pos <span style="color: #555555">=</span> <span style="color: #FF6600">9</span>
    <span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(run):
        pos <span style="color: #555555">=</span> neighbor[pos][ random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
    list_vec<span style="color: #555555">.</span>append(pos)

x <span style="color: #555555">=</span> [xvec[k] <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> list_vec]
y <span style="color: #555555">=</span> [yvec[k] <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> list_vec]

plt<span style="color: #555555">.</span>xticks([])
plt<span style="color: #555555">.</span>yticks([])

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;create a Histogram&#39;&#39;&#39;</span>
H, xedges, yedges <span style="color: #555555">=</span> np<span style="color: #555555">.</span>histogram2d(x, y, bins<span style="color: #555555">=</span>(<span style="color: #FF6600">3</span>, <span style="color: #FF6600">3</span>), 
           <span style="color: #336666">range</span><span style="color: #555555">=</span>[[<span style="color: #FF6600">1</span>,<span style="color: #FF6600">3</span>],[<span style="color: #FF6600">1</span>,<span style="color: #FF6600">3</span>]], normed<span style="color: #555555">=</span><span style="color: #336666">True</span>)
<span style="color: #006699; font-weight: bold">print</span> H
H <span style="color: #555555">/=</span> np<span style="color: #555555">.</span>sum(H)
<span style="color: #006699; font-weight: bold">print</span> H

<span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;plot Histogram&#39;&#39;&#39;</span>

extent <span style="color: #555555">=</span> [yedges[<span style="color: #FF6600">0</span>], yedges[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>], xedges[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>], xedges[<span style="color: #FF6600">0</span>]]
plt<span style="color: #555555">.</span>imshow(H, extent<span style="color: #555555">=</span>extent, interpolation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nearest&#39;</span>, vmin<span style="color: #555555">=</span><span style="color: #FF6600">0.0</span>, vmax<span style="color: #555555">=</span><span style="color: #FF6600">1.0</span>)
plt<span style="color: #555555">.</span>set_cmap(<span style="color: #CC3300">&#39;hot&#39;</span>)
plt<span style="color: #555555">.</span>colorbar()
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;t = &#39;</span><span style="color: #555555">+</span><span style="color: #336666">str</span>(run),fontsize<span style="color: #555555">=</span><span style="color: #FF6600">22</span>)
plt<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&#39;3x3_pebble_run_&#39;</span><span style="color: #555555">+</span>run_str<span style="color: #555555">+</span><span style="color: #CC3300">&#39;.png&#39;</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[[ 0.    0.    2.25]
 [ 0.    0.    0.  ]
 [ 0.    0.    0.  ]]
[[ 0.  0.  1.]
 [ 0.  0.  0.]
 [ 0.  0.  0.]]
</pre></div>


<p><img alt="png" src="../output_23_1.png" /></p>
<p>Multiple Histogram</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>xvec <span style="color: #555555">=</span> {<span style="color: #FF6600">1</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">3</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">5</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">6</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">7</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">8</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">9</span>:<span style="color: #FF6600">1</span>} 
yvec <span style="color: #555555">=</span> {<span style="color: #FF6600">1</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>:<span style="color: #FF6600">1</span>, <span style="color: #FF6600">4</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">6</span>:<span style="color: #FF6600">2</span>, <span style="color: #FF6600">7</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">8</span>:<span style="color: #FF6600">3</span>, <span style="color: #FF6600">9</span>:<span style="color: #FF6600">3</span>} 


N_runs <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N_runs):
    list_vec <span style="color: #555555">=</span> []
    <span style="color: #006699; font-weight: bold">if</span> run <span style="color: #555555">&lt;</span> <span style="color: #FF6600">10</span>:  run_str<span style="color: #555555">=</span> <span style="color: #CC3300">&#39;0&#39;</span><span style="color: #555555">+</span><span style="color: #336666">str</span>(run)
    <span style="color: #006699; font-weight: bold">else</span>: run_str <span style="color: #555555">=</span> <span style="color: #336666">str</span>(run)
    <span style="color: #006699; font-weight: bold">for</span> n_runs <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">100000</span>): 
        pos <span style="color: #555555">=</span> <span style="color: #FF6600">9</span>
        <span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(run):
            pos <span style="color: #555555">=</span> neighbor[pos][ random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
        list_vec<span style="color: #555555">.</span>append(pos)

    x <span style="color: #555555">=</span> [xvec[k] <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> list_vec]
    y <span style="color: #555555">=</span> [yvec[k] <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> list_vec]

    plt<span style="color: #555555">.</span>subplot(<span style="color: #FF6600">2</span>,<span style="color: #FF6600">2</span>,run<span style="color: #555555">+</span><span style="color: #FF6600">1</span>)
    plt<span style="color: #555555">.</span>xticks([])
    plt<span style="color: #555555">.</span>yticks([])
    H, xedges, yedges <span style="color: #555555">=</span> np<span style="color: #555555">.</span>histogram2d(x, y, bins<span style="color: #555555">=</span>(<span style="color: #FF6600">3</span>, <span style="color: #FF6600">3</span>), 
               <span style="color: #336666">range</span><span style="color: #555555">=</span>[[<span style="color: #FF6600">1</span>,<span style="color: #FF6600">3</span>],[<span style="color: #FF6600">1</span>,<span style="color: #FF6600">3</span>]], normed<span style="color: #555555">=</span><span style="color: #336666">True</span>)
    <span style="color: #0099FF; font-style: italic">#print H</span>
    H <span style="color: #555555">/=</span> np<span style="color: #555555">.</span>sum(H)
    <span style="color: #0099FF; font-style: italic"># print H</span>
    extent <span style="color: #555555">=</span> [yedges[<span style="color: #FF6600">0</span>], yedges[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>], xedges[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>], xedges[<span style="color: #FF6600">0</span>]]
    histo <span style="color: #555555">=</span> plt<span style="color: #555555">.</span>imshow(H, extent<span style="color: #555555">=</span>extent, interpolation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nearest&#39;</span>, vmin<span style="color: #555555">=</span><span style="color: #FF6600">0</span>, vmax<span style="color: #555555">=</span><span style="color: #FF6600">1.00</span>)
    histo<span style="color: #555555">.</span>set_cmap(<span style="color: #CC3300">&#39;hot&#39;</span>)
    plt<span style="color: #555555">.</span>colorbar()
    plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;t = &#39;</span><span style="color: #555555">+</span><span style="color: #336666">str</span>(run),fontsize<span style="color: #555555">=</span><span style="color: #FF6600">10</span>)
    <span style="color: #0099FF; font-style: italic">#plt.savefig(&#39;marcob/3x3_pebble_run_&#39;+run_str+&#39;.png&#39;)</span>
    <span style="color: #0099FF; font-style: italic">#plt.close()</span>
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_25_0.png" /></p>
<ul>
<li>Pebble movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">grider</span>():
    pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">1.5</span>], <span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">2.5</span>], <span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">1.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], <span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">2.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], <span style="color: #CC3300">&#39;b&#39;</span>)
    <span style="color: #006699; font-weight: bold">return</span>
grider()
</pre></div>


<p><img alt="png" src="../output_27_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.4</span>  <span style="color: #0099FF; font-style: italic"># sigma and s_map are needed for the graphical output</span>
s_map <span style="color: #555555">=</span> [(<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">1.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">1.0</span>), 
         (<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">2.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">2.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">2.0</span>), 
         (<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">3.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">3.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">3.0</span>)] 
neighbor_o <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">4</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">4</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>]]
site <span style="color: #555555">=</span> <span style="color: #FF6600">8</span>
N_runs <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
<span style="color: #006699; font-weight: bold">for</span> run <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N_runs):
    <span style="color: #006699; font-weight: bold">if</span> run <span style="color: #555555">&lt;</span> <span style="color: #FF6600">10</span>: number_string <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;0&#39;</span><span style="color: #555555">+</span><span style="color: #336666">str</span>(run)
    <span style="color: #006699; font-weight: bold">else</span>: number_string <span style="color: #555555">=</span> <span style="color: #336666">str</span>(run)
    <span style="color: #0099FF; font-style: italic"># Begin of graphical output</span>
    cir <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle(s_map[site], radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span><span style="color: #CC3300">&#39;r&#39;</span>)
    pylab<span style="color: #555555">.</span>subplot(<span style="color: #FF6600">5</span>,<span style="color: #FF6600">2</span>,run<span style="color: #555555">+</span><span style="color: #FF6600">1</span>)
    pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(cir)
    grider()
    pylab<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;t = &#39;</span><span style="color: #555555">+</span> number_string)
    pylab<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;scaled&#39;</span>)
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>])
    pylab<span style="color: #555555">.</span>xticks([])
    pylab<span style="color: #555555">.</span>yticks([])
    <span style="color: #0099FF; font-style: italic">#pylab.savefig(&#39;peeble_movie/pebble_basic_movie_&#39;+number_string+&#39;.png&#39;, transparent=False)</span>
    <span style="color: #0099FF; font-style: italic">#pylab.show()    </span>
    <span style="color: #0099FF; font-style: italic">#pylab.clf()</span>
    <span style="color: #0099FF; font-style: italic"># End of graphical output</span>
    site <span style="color: #555555">=</span> neighbor_o[site][ random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
pylab<span style="color: #555555">.</span>show()   
</pre></div>


<p><img alt="png" src="../output_28_0.png" /></p>
<h3 id="peeble-dual">Peeble-Dual</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">double_grider</span>():
        pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">6.5</span>, <span style="color: #555555">-</span><span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">3.5</span>])
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">0.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">1.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">2.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">1.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">2.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">3.5</span>, <span style="color: #FF6600">3.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">3.5</span>], <span style="color: #CC3300">&#39;r&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">1.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">1.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">2.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">2.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">3.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">0.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">0.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">0.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">1.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">1.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">0.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">2.5</span><span style="color: #555555">+</span>offset, <span style="color: #FF6600">2.5</span><span style="color: #555555">+</span>offset], [<span style="color: #FF6600">0.5</span><span style="color: #555555">-</span>offset, <span style="color: #FF6600">3.5</span><span style="color: #555555">-</span>offset], <span style="color: #CC3300">&#39;b&#39;</span>)
        <span style="color: #006699; font-weight: bold">return</span>
double_grider()
</pre></div>


<p><img alt="png" src="../output_30_0.png" /></p>
<ul>
<li>Pebble transfer strategy</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>transfer <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros((<span style="color: #FF6600">9</span>, <span style="color: #FF6600">9</span>))
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>):
    <span style="color: #006699; font-weight: bold">for</span> neigh <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">4</span>): transfer[neighbor_o[k][neigh], k] <span style="color: #555555">+=</span> <span style="color: #FF6600">0.25</span>
position <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(<span style="color: #FF6600">9</span>)
position[<span style="color: #FF6600">8</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>
<span style="color: #006699; font-weight: bold">for</span> t <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">10</span>):
    <span style="color: #006699; font-weight: bold">print</span> t,<span style="color: #CC3300">&#39;  &#39;</span>,[<span style="color: #CC3300">&quot;</span><span style="color: #AA0000">%0.5f</span><span style="color: #CC3300">&quot;</span> <span style="color: #555555">%</span> <span style="color: #336666">abs</span>(i<span style="color: #555555">-</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">/</span> <span style="color: #FF6600">9.0</span>) <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> position]
    position <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(transfer, position)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>0    [&#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.88889&#39;]
1    [&#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.13889&#39;, &#39;0.11111&#39;, &#39;0.13889&#39;, &#39;0.38889&#39;]
2    [&#39;0.11111&#39;, &#39;0.11111&#39;, &#39;0.04861&#39;, &#39;0.11111&#39;, &#39;0.01389&#39;, &#39;0.07639&#39;, &#39;0.04861&#39;, &#39;0.07639&#39;, &#39;0.26389&#39;]
3    [&#39;0.11111&#39;, &#39;0.06424&#39;, &#39;0.03299&#39;, &#39;0.06424&#39;, &#39;0.01736&#39;, &#39;0.07639&#39;, &#39;0.03299&#39;, &#39;0.07639&#39;, &#39;0.17014&#39;]
4    [&#39;0.08767&#39;, &#39;0.05642&#39;, &#39;0.01345&#39;, &#39;0.05642&#39;, &#39;0.00608&#39;, &#39;0.04905&#39;, &#39;0.01345&#39;, &#39;0.04905&#39;, &#39;0.12326&#39;]
5    [&#39;0.07205&#39;, &#39;0.03787&#39;, &#39;0.00857&#39;, &#39;0.03787&#39;, &#39;0.00369&#39;, &#39;0.04123&#39;, &#39;0.00857&#39;, &#39;0.04123&#39;, &#39;0.08615&#39;]
6    [&#39;0.05496&#39;, &#39;0.03054&#39;, &#39;0.00345&#39;, &#39;0.03054&#39;, &#39;0.00168&#39;, &#39;0.02878&#39;, &#39;0.00345&#39;, &#39;0.02878&#39;, &#39;0.06369&#39;]
7    [&#39;0.04275&#39;, &#39;0.02182&#39;, &#39;0.00216&#39;, &#39;0.02182&#39;, &#39;0.00088&#39;, &#39;0.02268&#39;, &#39;0.00216&#39;, &#39;0.02268&#39;, &#39;0.04624&#39;]
8    [&#39;0.03228&#39;, &#39;0.01690&#39;, &#39;0.00087&#39;, &#39;0.01690&#39;, &#39;0.00043&#39;, &#39;0.01647&#39;, &#39;0.00087&#39;, &#39;0.01647&#39;, &#39;0.03446&#39;]
9    [&#39;0.02459&#39;, &#39;0.01241&#39;, &#39;0.00054&#39;, &#39;0.01241&#39;, &#39;0.00022&#39;, &#39;0.01262&#39;, &#39;0.00054&#39;, &#39;0.01262&#39;, &#39;0.02546&#39;]
</pre></div>


<ul>
<li>Pebble transfer Eigen</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span>

neighbor <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">4</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">4</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>]]
transfer <span style="color: #555555">=</span> numpy<span style="color: #555555">.</span>zeros((<span style="color: #FF6600">18</span>, <span style="color: #FF6600">18</span>))
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>):
    <span style="color: #006699; font-weight: bold">for</span> neigh <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">4</span>): 
        transfer[neighbor[k][neigh], k] <span style="color: #555555">+=</span> <span style="color: #FF6600">0.25</span>     <span style="color: #0099FF; font-style: italic"># red pebble game</span>
        transfer[neighbor[k][neigh]<span style="color: #555555">+</span><span style="color: #FF6600">9</span>, k<span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">+=</span> <span style="color: #FF6600">0.25</span> <span style="color: #0099FF; font-style: italic"># blue pebble game   </span>
<span style="color: #0099FF; font-style: italic"># small transition epsilon between red 2 and blue 6</span>
epsilon <span style="color: #555555">=</span> <span style="color: #FF6600">0.04</span>
transfer[<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>,<span style="color: #FF6600">2</span>] <span style="color: #555555">=</span> transfer[<span style="color: #FF6600">2</span>,<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">=</span> epsilon
transfer[<span style="color: #FF6600">2</span>,<span style="color: #FF6600">2</span>] <span style="color: #555555">-=</span> epsilon
transfer[<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>,<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">-=</span> epsilon
eigenvalues, eigenvectors <span style="color: #555555">=</span> numpy<span style="color: #555555">.</span>linalg<span style="color: #555555">.</span>eig(transfer)
<span style="color: #006699; font-weight: bold">print</span> eigenvalues

<span style="color: #0099FF; font-style: italic"># you may print the eigenvectors by uncommenting the following four lines</span>
<span style="color: #0099FF; font-style: italic">#for iter in range(18):</span>
<span style="color: #0099FF; font-style: italic">#    print eigenvalues[iter]</span>
<span style="color: #0099FF; font-style: italic">#    for i in range(18):</span>
<span style="color: #0099FF; font-style: italic">#        print eigenvectors[i][iter]</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[ -5.02430015e-01  -5.00000000e-01   1.00000000e+00   9.92451031e-01
   7.25649298e-01   5.00000000e-01   4.79023434e-01  -1.50050555e-02
   2.40311308e-01   7.50000000e-01   7.50000000e-01   1.52303605e-17
   7.50000000e-01  -1.04083409e-16   1.07326675e-17   2.50000000e-01
   2.50000000e-01   2.50000000e-01]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>random<span style="color: #555555">.</span>seed(<span style="color: #CC3300">&#39;1234&#39;</span>)
sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.4</span>
epsilon <span style="color: #555555">=</span> <span style="color: #FF6600">0.4</span>  <span style="color: #0099FF; font-style: italic"># probability to switch from red to blue pebble, and vice versa</span>

pylab<span style="color: #555555">.</span>figure()

s_map_red <span style="color: #555555">=</span>  [(<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">1.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">1.0</span>), 
              (<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">2.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">2.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">2.0</span>), 
              (<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">3.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">3.0</span>), (<span style="color: #FF6600">3.0</span>, <span style="color: #FF6600">3.0</span>)] 
offset <span style="color: #555555">=</span> <span style="color: #FF6600">3.0</span>
s_map_blue <span style="color: #555555">=</span> [(x<span style="color: #555555">+</span>offset,y<span style="color: #555555">-</span>offset) <span style="color: #006699; font-weight: bold">for</span> (x,y) <span style="color: #000000; font-weight: bold">in</span> s_map_red]

color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;red&#39;</span>  <span style="color: #0099FF; font-style: italic">#chose &#39;red&#39; or &#39;blue&#39;</span>
site <span style="color: #555555">=</span> <span style="color: #FF6600">8</span>
tmax <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>



<span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(tmax):
    period <span style="color: #555555">=</span> <span style="color: #FF6600">4</span>
    <span style="color: #006699; font-weight: bold">if</span> (<span style="color: #336666">iter</span><span style="color: #555555">%</span>period) <span style="color: #555555">==</span> <span style="color: #FF6600">0</span>:
    <span style="color: #0099FF; font-style: italic"># Begin of graphical output</span>
        maxlength <span style="color: #555555">=</span> <span style="color: #336666">len</span>(<span style="color: #336666">str</span>(tmax<span style="color: #555555">-</span><span style="color: #FF6600">1</span>))
        number_string <span style="color: #555555">=</span> <span style="color: #336666">str</span>(<span style="color: #336666">iter</span>)<span style="color: #555555">.</span>zfill(maxlength)
        <span style="color: #006699; font-weight: bold">if</span> color <span style="color: #555555">==</span> <span style="color: #CC3300">&#39;red&#39;</span>:  cir <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle(s_map_red[site],  radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span><span style="color: #CC3300">&#39;r&#39;</span>)
        <span style="color: #006699; font-weight: bold">if</span> color <span style="color: #555555">==</span> <span style="color: #CC3300">&#39;blue&#39;</span>: cir <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle(s_map_blue[site], radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span><span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>figure()
        <span style="color: #0099FF; font-style: italic">#pylab.subplot(2,2,iter)</span>
        pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(cir)
        double_grider()
        pylab<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;t = &#39;</span><span style="color: #555555">+</span> number_string)
        pylab<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;scaled&#39;</span>)
        pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">6.5</span>, <span style="color: #555555">-</span><span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">3.5</span>])
        pylab<span style="color: #555555">.</span>xticks([])
        pylab<span style="color: #555555">.</span>yticks([])
        number_string_filename <span style="color: #555555">=</span> <span style="color: #336666">str</span>(<span style="color: #336666">iter</span><span style="color: #555555">/</span>period)<span style="color: #555555">.</span>zfill(<span style="color: #FF6600">3</span>)
        <span style="color: #0099FF; font-style: italic">#pylab.savefig(&#39;peeble_dual/pebble_dual_movie_epsilon_&#39;+number_string_filename+&#39;.png&#39;, transparent=True)</span>
        <span style="color: #0099FF; font-style: italic">#pylab.clf()</span>
        <span style="color: #0099FF; font-style: italic">#pylab.close()</span>
        pylab<span style="color: #555555">.</span>show()
    <span style="color: #0099FF; font-style: italic"># End of graphical output</span>



    newsite <span style="color: #555555">=</span> neighbor_o[site][ random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">3</span>)]
    newcolor <span style="color: #555555">=</span> color
    <span style="color: #006699; font-weight: bold">if</span> (color <span style="color: #555555">==</span> <span style="color: #CC3300">&#39;red&#39;</span>) <span style="color: #000000; font-weight: bold">and</span> (site <span style="color: #555555">==</span> <span style="color: #FF6600">2</span>) <span style="color: #000000; font-weight: bold">and</span> (newsite <span style="color: #555555">==</span> <span style="color: #FF6600">2</span>):
        <span style="color: #006699; font-weight: bold">if</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">&lt;</span> epsilon:
            newcolor <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;blue&#39;</span>
            newsite <span style="color: #555555">=</span> <span style="color: #FF6600">6</span>
            <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&quot;transition red-&gt;blue at time = &quot;</span>, <span style="color: #336666">iter</span>
    <span style="color: #006699; font-weight: bold">if</span> (color <span style="color: #555555">==</span> <span style="color: #CC3300">&#39;blue&#39;</span>) <span style="color: #000000; font-weight: bold">and</span> (site <span style="color: #555555">==</span> <span style="color: #FF6600">6</span>) <span style="color: #000000; font-weight: bold">and</span> (newsite <span style="color: #555555">==</span> <span style="color: #FF6600">6</span>):
        <span style="color: #006699; font-weight: bold">if</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">&lt;</span> epsilon:
            newcolor <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;red&#39;</span>
            newsite <span style="color: #555555">=</span> <span style="color: #FF6600">2</span>
            <span style="color: #006699; font-weight: bold">print</span> <span style="color: #CC3300">&quot;transition blue-&gt;red at time = &quot;</span>, <span style="color: #336666">iter</span>
    site <span style="color: #555555">=</span> newsite
    color <span style="color: #555555">=</span> newcolor
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;matplotlib.figure.Figure at 0x10aa4cd50&amp;gt;
</pre></div>


<p><img alt="png" src="../output_35_1.png" /></p>
<p><img alt="png" src="../output_35_2.png" /></p>
<p><img alt="png" src="../output_35_3.png" /></p>
<ul>
<li>Pebble Dual Eigen</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span>

neighbor <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">2</span>, <span style="color: #FF6600">5</span>, <span style="color: #FF6600">1</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">4</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">0</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">3</span>, <span style="color: #FF6600">1</span>], [<span style="color: #FF6600">5</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">4</span>, <span style="color: #FF6600">2</span>],
             [<span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">3</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">6</span>, <span style="color: #FF6600">4</span>], [<span style="color: #FF6600">8</span>, <span style="color: #FF6600">8</span>, <span style="color: #FF6600">7</span>, <span style="color: #FF6600">5</span>]]
transfer <span style="color: #555555">=</span> numpy<span style="color: #555555">.</span>zeros((<span style="color: #FF6600">18</span>, <span style="color: #FF6600">18</span>))
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>):
    <span style="color: #006699; font-weight: bold">for</span> neigh <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">4</span>): 
        transfer[neighbor[k][neigh], k] <span style="color: #555555">+=</span> <span style="color: #FF6600">0.25</span>     <span style="color: #0099FF; font-style: italic"># red pebble game</span>
        transfer[neighbor[k][neigh]<span style="color: #555555">+</span><span style="color: #FF6600">9</span>, k<span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">+=</span> <span style="color: #FF6600">0.25</span> <span style="color: #0099FF; font-style: italic"># blue pebble game   </span>
<span style="color: #0099FF; font-style: italic"># small transition epsilon between red 2 and blue 6</span>
epsilon <span style="color: #555555">=</span> <span style="color: #FF6600">0.04</span>
transfer[<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>,<span style="color: #FF6600">2</span>] <span style="color: #555555">=</span> transfer[<span style="color: #FF6600">2</span>,<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">=</span> epsilon
transfer[<span style="color: #FF6600">2</span>,<span style="color: #FF6600">2</span>] <span style="color: #555555">-=</span> epsilon
transfer[<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>,<span style="color: #FF6600">6</span><span style="color: #555555">+</span><span style="color: #FF6600">9</span>] <span style="color: #555555">-=</span> epsilon
eigenvalues, eigenvectors <span style="color: #555555">=</span> numpy<span style="color: #555555">.</span>linalg<span style="color: #555555">.</span>eig(transfer)
<span style="color: #006699; font-weight: bold">print</span> eigenvalues

<span style="color: #0099FF; font-style: italic"># you may print the eigenvectors by uncommenting the following four lines</span>
<span style="color: #0099FF; font-style: italic">#for iter in range(18):</span>
<span style="color: #0099FF; font-style: italic">#    print eigenvalues[iter]</span>
<span style="color: #0099FF; font-style: italic">#    for i in range(18):</span>
<span style="color: #0099FF; font-style: italic">#        print eigenvectors[i][iter]</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[ -5.02430015e-01  -5.00000000e-01   1.00000000e+00   9.92451031e-01
   7.25649298e-01   5.00000000e-01   4.79023434e-01  -1.50050555e-02
   2.40311308e-01   7.50000000e-01   7.50000000e-01   1.52303605e-17
   7.50000000e-01  -1.04083409e-16   1.07326675e-17   2.50000000e-01
   2.50000000e-01   2.50000000e-01]
</pre></div>


<ul>
<li>Pebble Recrrunt Movie</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">math</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">random</span><span style="color: #555555">,</span> <span style="color: #00CCFF; font-weight: bold">pylab</span>

sigma <span style="color: #555555">=</span> <span style="color: #FF6600">0.4</span>
epsilon <span style="color: #555555">=</span> <span style="color: #FF6600">0.1</span>
pylab<span style="color: #555555">.</span>figure()
s_map <span style="color: #555555">=</span> [(<span style="color: #FF6600">1.0</span>, <span style="color: #FF6600">1.0</span>), (<span style="color: #FF6600">2.0</span>, <span style="color: #FF6600">1.0</span>)] 
neighbor <span style="color: #555555">=</span>  [[<span style="color: #FF6600">1</span>], [<span style="color: #FF6600">0</span>]]
pos <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
tmax <span style="color: #555555">=</span> <span style="color: #FF6600">5</span>
<span style="color: #006699; font-weight: bold">for</span> <span style="color: #336666">iter</span> <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(tmax):
    <span style="color: #0099FF; font-style: italic"># Begin of the graphics output</span>
    pylab<span style="color: #555555">.</span>figure()
    number_string <span style="color: #555555">=</span> <span style="color: #336666">str</span>(<span style="color: #336666">iter</span>)<span style="color: #555555">.</span>zfill(<span style="color: #336666">len</span>(<span style="color: #336666">str</span>(tmax)))
    cir <span style="color: #555555">=</span> pylab<span style="color: #555555">.</span>Circle(s_map[pos], radius<span style="color: #555555">=</span>sigma, fc<span style="color: #555555">=</span><span style="color: #CC3300">&#39;r&#39;</span>)
    pylab<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>add_patch(cir)
    pylab<span style="color: #555555">.</span>plot([<span style="color: #FF6600">1.5</span>, <span style="color: #FF6600">1.5</span>], [<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">1.5</span>], <span style="color: #CC3300">&#39;b&#39;</span>)
    pylab<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;t = &#39;</span><span style="color: #555555">+</span> number_string)
    pylab<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&#39;scaled&#39;</span>)
    pylab<span style="color: #555555">.</span>axis([<span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">2.5</span>, <span style="color: #FF6600">0.5</span>, <span style="color: #FF6600">1.5</span>])
    pylab<span style="color: #555555">.</span>xticks([])
    pylab<span style="color: #555555">.</span>yticks([])
    pylab<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&#39;recurrent/2x1pebble_epsilon&#39;</span><span style="color: #555555">+</span>number_string<span style="color: #555555">+</span><span style="color: #CC3300">&#39;.png&#39;</span>, transparent<span style="color: #555555">=</span><span style="color: #336666">True</span>)
    <span style="color: #0099FF; font-style: italic">#pylab.close()</span>
    pylab<span style="color: #555555">.</span>show()
    <span style="color: #0099FF; font-style: italic"># End of the graphics output</span>
    newpos <span style="color: #555555">=</span> neighbor[pos][<span style="color: #FF6600">0</span>]
    <span style="color: #006699; font-weight: bold">if</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">&lt;</span> epsilon:
        newpos <span style="color: #555555">=</span> pos
    pos <span style="color: #555555">=</span> newpos
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;matplotlib.figure.Figure at 0x10a282e10&amp;gt;
</pre></div>


<p><img alt="png" src="../output_39_1.png" /></p>
<p><img alt="png" src="../output_39_2.png" /></p>
<p><img alt="png" src="../output_39_3.png" /></p>
<p><img alt="png" src="../output_39_4.png" /></p>
<p><img alt="png" src="../output_39_5.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span>

epsilon <span style="color: #555555">=</span> <span style="color: #FF6600">0.01</span>
transfer <span style="color: #555555">=</span> [[ epsilon, <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> epsilon ],
            [ <span style="color: #FF6600">1.0</span> <span style="color: #555555">-</span> epsilon, epsilon ]]
eigenvalues, eigenvectors <span style="color: #555555">=</span> numpy<span style="color: #555555">.</span>linalg<span style="color: #555555">.</span>eig(transfer)
<span style="color: #006699; font-weight: bold">print</span> eigenvalues

<span style="color: #0099FF; font-style: italic"># you may print the eigenvectors by uncommenting the following lines...</span>
<span style="color: #0099FF; font-style: italic">#for iter in range(2):</span>
<span style="color: #0099FF; font-style: italic">#    print eigenvalues[iter]</span>
<span style="color: #0099FF; font-style: italic">#    for i in range(2):</span>
<span style="color: #0099FF; font-style: italic">#       print eigenvectors[i][iter]</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[ 1.   -0.98]
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../RandomWalk/Rwalk/" class="btn btn-neutral float-right" title="Random Walk">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="./" class="btn btn-neutral" title="Getting Started Monte Carlo Simulation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="./" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../RandomWalk/Rwalk/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
