<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Lottary Model - Computational Physics</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Lottary Model";
    var mkdocs_page_input_path = "Montecarlo/Lotto/lotto.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Computational Physics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../WhyComputationalPhysics/">Why Computational Physics</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Scipy</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Scipy/intro/Numerical-Methods/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Scipy/Harmonics/Harmonics/">Spherical Harmonics</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Scipy/Bessel/Bessel/">Oscillating Membrane</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Scipy/Laplace/laplace/">Laplace Equation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Monte Carlo Simulation</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../GettingStarted/intro/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../GettingStarted/intro/">Algorithms</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Lottary Model
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#lotto-dynamics-in-integer-space">
      Lotto Dynamics in Integer Space
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
          

  <li class="toctree-l3 current with-children">
    <a href="#11-construction-of-a-toy-model">
      1.1.  Construction of a Toy Model
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3 current">
    <ul class="subnav-l3 current">
    
      
          

  <li class="toctree-l4 current with-children">
    <a href="#111-model-selection-with-proper-action">
      1.1.1.   Model Selection with Proper Action
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4 current">
    <ul class="subnav-l4 current">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#model-i-linear">Model-I (Linear)</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#model-ii-linear-periodic">Model-II (Linear &amp;Periodic)</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#model-iii-quadratic-periodic">Model - III (Quadratic &amp; Periodic)</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l4">
    <a href="#112-study-of-distance-matrix">
      1.1.2. Study of Distance Matrix
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4">
    <ul class="subnav-l4 toc-hidden">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1121-enasmble-of-distance-matrices">1.1.2.1 Enasmble of Distance matrices</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#principle-component-analysis-model-iii">Principle Component Analysis - Model -III</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#principle-component-analysis-model-ii">Principle Component Analysis - Model - II</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l4">
    <a href="#113-statistical-analysis-determination-of-spring-constants">
      1.1.3. Statistical Analysis &amp; Determination of Spring Constants
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4">
    <ul class="subnav-l4 toc-hidden">
    
      
          

  <li class="toctree-l5 current with-children">
    <a href="#1131-study-of-variance-covariance-matrix-of-samples">
      1.1.3.1.  Study of Variance-Covariance  Matrix of samples
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l5 current">
    <ul class="subnav-l5 current">
    
      
        <li class="toctree-l6">
          <a class="toctree-l7" href="#1132a-variance-covariance-of-raw-samples">1.1.3.2.a. Variance-Covariance of Raw samples</a>
        </li>
    
      
        <li class="toctree-l6">
          <a class="toctree-l7" href="#1132b-variance-covariance-of-normalized-samples-crrelation-cofficients">1.1.3.2.b. Variance-Covariance of Normalized samples : Crrelation cofficients</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>

      
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#1133-spring-constants">1.1.3.3. Spring Constants</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#12-montecarlo-simulation">
      1.2 Montecarlo Simulation
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
          

  <li class="toctree-l4 current with-children">
    <a href="#121-thermalization">
      1.2.1 Thermalization
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4 current">
    <ul class="subnav-l4 current">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#test-mode">Test mode</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#thermal-mode">Thermal mode</a>
        </li>
    
    </ul>
  </li>

      
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#measurement-of-average-absolute-difference">Measurement of average  absolute difference</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#measurement-of-root-mean-square-absolute-difference">Measurement of root mean square absolute difference</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#13-interpretation">
      1.3. Interpretation
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
          

  <li class="toctree-l4 current with-children">
    <a href="#131-most-probable-samples-using-model-iii-constrained-by-rms-absolute-difference">
      1.3.1. Most Probable Samples using Model -III : constrained by rms absolute difference
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4 current">
    <ul class="subnav-l4 current">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1312-generation-of-many-samples-and-their-actions">1.3.1.2. Generation of many  samples and their actions</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1313-histogram-plot-of-frequencies">1.3.1.3. Histogram Plot of frequencies</a>
        </li>
    
    </ul>
  </li>

      
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#1314-generate-some-sample">1.3.1.4.  Generate some sample</a>
        </li>
    
      
          

  <li class="toctree-l4">
    <a href="#132-most-probable-samples-using-model-i-without-any-constraint-from-thermalization">
      1.3.2. Most Probable Samples using Model -I : without any constraint from thermalization
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4">
    <ul class="subnav-l4 toc-hidden">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1321-calculation-of-action-in-each-sample">1.3.2.1. Calculation of action in each sample</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1322-generation-of-many-n_samples-samples-and-their-actions">1.3.2.2. Generation of many (N_samples) samples and their actions</a>
        </li>
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#1323-histogram-plot-of-frequencies">1.3.2.3. Histogram Plot of frequencies</a>
        </li>
    
    </ul>
  </li>

      
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#1324-generate-some-sample">1.3.2.4.  Generate some sample</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IdealGas/IdealGas/">Ideal Gas</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Oscillator/Oscillator/">Harmonic Oscillator</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../IzingModel/Izing2D/">Ising Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Percolation/percol/">Percolation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../HardDisk/hd/">Hard Disk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Levy/levy/">Quantum Monte Carlo</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../BEC/bec/">Bose-Einstein Condensation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Optimization</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/intro/Optimization/">Optimization</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../optimization/SimulatedAnealing/simulatedAnn/">Simulated Annealing</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Path Integral</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../PathIntegral/Intro/Intro/">Path Integral</a>
  </li>
        
      </ul>
    </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../References/">References</a>
  </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Computational Physics</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Monte Carlo Simulation &raquo;</li>
        
      
    
    <li>Lottary Model</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="lotto-dynamics-in-integer-space">Lotto Dynamics in Integer Space</h1>
<p>We find a proper model to represent the dynamics of the system in positive integer space [1 to 69] using random number generator. With this model we  run Hybrid Montecarlo(HMC) algorithm to thermalize the system to determine most probable values of quantities like: average absolute difference, root mean square absolute difference and most probable absolute difference, which are helpful to determine the most probable vectors in sample space.</p>
<p>Import some libraries</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">random</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">import</span> linalg <span style="color: #006699; font-weight: bold">as</span> LA
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">math</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">math</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">pandas</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #555555">%</span>matplotlib inline
</pre></div>


<p>Maximum no in range of lottery</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Max <span style="color: #555555">=</span> <span style="color: #FF6600">69</span>
</pre></div>


<p>This function generates 5 random samples between 1 to 65.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">sample_generator</span>(Max):
    x <span style="color: #555555">=</span>     np<span style="color: #555555">.</span>sort(random<span style="color: #555555">.</span>sample(<span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>,Max), <span style="color: #FF6600">5</span>) ) 
    <span style="color: #006699; font-weight: bold">return</span> x
</pre></div>


<hr />
<h2 id="11-construction-of-a-toy-model">1.1.  Construction of a Toy Model</h2>
<p>For example, considering range of sample equal to 50, among millions of sample one gets:</p>
<ul>
<li>mean of first no : 5</li>
<li>mean of second no :15</li>
<li>mean of third no :25</li>
<li>mean of  fourth no:35</li>
<li>mean of fifth no:45</li>
</ul>
<p>We consider these mean values as equilibrium point of each oscillator. Oscillators oscillate in integer Space. Each sample of lottery is some state of oscillator. There will be total of (50x49x48x47x46/5!) states. We can choose best modle of oscillator by making a study of correlation cofficients among digits in each sample. Here we have proposed 3 model where model I and II are special case of Model III.</p>
<h3 id="111-model-selection-with-proper-action">1.1.1.   Model Selection with Proper Action</h3>
<p><img src="https://sites.science.oregonstate.edu/~roundyd/COURSES/ph427/figs/ring-of-oscillators.svg" width = 200 height =200></p>
<p>Let us define a skewsymmetric distance matrix  by taking difference between digits in sample as the matrix elements. There is one distance matrix per sample.</p>
<p>$$D_{ij} =  (x_{i}-x_{j})$$</p>
<p>ie. </p>
<p>\( D = \left( \begin{array}{ccc}
0 &amp; \color{blue}{(x_{1}-x_{2})} &amp; (x_{1}-x_{3})&amp; (x_{1}-x_{4}) &amp; (x_{1}-x_{5}) \\
(x_{2}-x_{1}) &amp; 0 &amp; \color{blue}{(x_{2}-x_{3})}&amp; (x_{2}-x_{4}) &amp; (x_{2}-x_{5}) \\
(x_{3}-x_{1}) &amp; (x_{3}-x_{2}) &amp; 0&amp; \color{blue}{(x_{3}-x_{4})} &amp; (x_{3}-x_{5}) \\
(x_{4}-x_{1}) &amp; (x_{4}-x_{2}) &amp; (x_{4}-x_{3})&amp; 0 &amp; \color{blue}{(x_{4}-x_{5})} \\
\color{blue}{(x_{5}-x_{1})} &amp; (x_{5}-x_{2}) &amp; (x_{5}-x_{3})&amp; (x_{5}-x_{4}) &amp; 0 \\
\end{array} \right) \)</p>
<p>Taking (N = 5) oscillators  with flexibility between seperation of numbers as spring constant (K=1). Simple  model of Action can be defined by taking single updiagonal terms only as:</p>
<h5 id="model-i-linear">Model-I (Linear)</h5>
<p>$$ L = \frac{1}{2}K[(x_1 -x_2)^2 +(x_2 -x_3)^2 + (x_3 -x_4)^2 + (x_4 -x_5)^2 ] $$</p>
<h5 id="model-ii-linear-periodic">Model-II (Linear &amp;Periodic)</h5>
<p>$$ L = \frac{1}{2}K[(x_1 -x_2)^2 +(x_2 -x_3)^2 + (x_3 -x_4)^2 + (x_4 -x_5)^2 + (x_5 -x_1)^2 ] $$</p>
<p>Considering effect of all terms in distance matrix one can define new model of Action as:</p>
<h5 id="model-iii-quadratic-periodic">Model - III (Quadratic &amp; Periodic)</h5>
<p>$$L = Tr(D^{\dagger}KD)$$</p>
<p>$$\color{red}{Warning:}$$ Since each digit are not equally correlated to eachother, this form of action should be corrected by choosing appropriate spring constant for crossed terms like $x_{3}x_{4}$. K is another matrix(or tensor) of spring constants which can be determined by finding correlation cofficients between digits within several samples.</p>
<hr />
<h3 id="112-study-of-distance-matrix">1.1.2. Study of Distance Matrix</h3>
<p>We can make skew symmetric matrix into traceless symmetric matrix by taking absolute value of each elements.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">distance_matrix</span>(x):
    D <span style="color: #555555">=</span> [[<span style="color: #FF6600">0.0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]<span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>):
        <span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>):
            D[k][l] <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[k]<span style="color: #555555">-</span>x[l])
    <span style="color: #006699; font-weight: bold">return</span> D       
</pre></div>


<p>Lets have a look of distance matrix:</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>distance_matrix(sample_generator(Max))
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[[0, 9, 24, 39, 44],
 [9, 0, 15, 30, 35],
 [24, 15, 0, 15, 20],
 [39, 30, 15, 0, 5],
 [44, 35, 20, 5, 0]]
</pre></div>


<p>We can generate a small bucket of  9 distance matices to visualize distribution of distances.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>M <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>],[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>],[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>],[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>],[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>]]) <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>)]
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>):
    M[k] <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(distance_matrix(x <span style="color: #555555">=</span> sample_generator(Max)))
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">9</span>):
    plt<span style="color: #555555">.</span>subplot(<span style="color: #FF6600">3</span>,<span style="color: #FF6600">3</span>,k<span style="color: #555555">+</span><span style="color: #FF6600">1</span>)
    plt<span style="color: #555555">.</span>imshow(M[<span style="color: #FF6600">0</span>], interpolation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nearest&#39;</span>, cmap<span style="color: #555555">=</span>plt<span style="color: #555555">.</span>cm<span style="color: #555555">.</span>ocean, extent<span style="color: #555555">=</span>(<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>,<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>))
    plt<span style="color: #555555">.</span>colorbar()

plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_34_0.png" /></p>
<h4 id="1121-enasmble-of-distance-matrices">1.1.2.1 Enasmble of Distance matrices</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>wstor_III <span style="color: #555555">=</span> []
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">10000</span>):
    x <span style="color: #555555">=</span> sample_generator(Max)
    A <span style="color: #555555">=</span> distance_matrix(x)
    w, v <span style="color: #555555">=</span> LA<span style="color: #555555">.</span>eig(A)
    <span style="color: #0099FF; font-style: italic">#print max(w)</span>
    <span style="color: #0099FF; font-style: italic">#for l in range(5):</span>
        <span style="color: #0099FF; font-style: italic">#wstor.append(abs(w[l]))</span>
    wstor_III<span style="color: #555555">.</span>append(<span style="color: #336666">max</span>(w))
    plt<span style="color: #555555">.</span>scatter(k,<span style="color: #336666">max</span>(w))
</pre></div>


<p><img alt="png" src="../output_36_0.png" /></p>
<p>Principle component of eigen values helps us to predict better model by dominancy of principle direction.</p>
<h4 id="principle-component-analysis-model-iii">Principle Component Analysis - Model -III</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;Plot of feequency of principle component in eigen values&quot;</span>)
plt<span style="color: #555555">.</span>hist(wstor_III,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_39_0.png" /></p>
<h4 id="principle-component-analysis-model-ii">Principle Component Analysis - Model - II</h4>
<p>In model - II , distance matrix becomes diagonal matrix and hence eigen values are diagonal elements themselves. We can plot distribution of largest difference.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>wstor_II <span style="color: #555555">=</span> []
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">10000</span>):
    x <span style="color: #555555">=</span> sample_generator(Max)
    A <span style="color: #555555">=</span> distance_matrix(x)
    w <span style="color: #555555">=</span> <span style="color: #336666">max</span>(A[<span style="color: #FF6600">0</span>][<span style="color: #FF6600">1</span>],A[<span style="color: #FF6600">1</span>][<span style="color: #FF6600">2</span>],A[<span style="color: #FF6600">2</span>][<span style="color: #FF6600">3</span>],A[<span style="color: #FF6600">3</span>][<span style="color: #FF6600">4</span>],A[<span style="color: #FF6600">4</span>][<span style="color: #FF6600">0</span>])
    wstor_II<span style="color: #555555">.</span>append(w)
    plt<span style="color: #555555">.</span>scatter(k,w)
</pre></div>


<p><img alt="png" src="../output_42_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;Plot of feequency of principle component in eigen values&quot;</span>)
plt<span style="color: #555555">.</span>hist(wstor_II,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_43_0.png" /></p>
<p>$$\color{blue}{Conclusion}$$ : Most of the distance matrices have principle component around 100. Principle compont depends on all distances. Therefore other distances can not be ignored in action. New action should be defined in term of Distance matrix.</p>
<hr />
<h3 id="113-statistical-analysis-determination-of-spring-constants">1.1.3. Statistical Analysis &amp; Determination of Spring Constants</h3>
<h4 id="1131-study-of-variance-covariance-matrix-of-samples">1.1.3.1.  Study of Variance-Covariance  Matrix of samples</h4>
<p>Study of Variance-Covariance help us to determine the spring constant(K) in our model which is ultimately related to the correlation coffecient. We construct Variance-Covariance Matirx by using 100 samples in the following steps:</p>
<ul>
<li>1 . Lets construct a bag of Nbag = 1000 samples.</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Nbag <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>SampleBag <span style="color: #555555">=</span> [sample_generator(Max) <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(Nbag)]
</pre></div>


<ul>
<li>2 . Vectorization of 100 samples : where first digit from each sample goes to first column vector  of Vec matrix etc.</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">vactorization</span>(SampleBag):
    Vec <span style="color: #555555">=</span> [[<span style="color: #FF6600">0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(Nbag)]<span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    <span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>): 
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(Nbag):
            Vec[l][k] <span style="color: #555555">=</span> SampleBag[k][l]
    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>array(Vec)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>SB <span style="color: #555555">=</span> vactorization(SampleBag)
p <span style="color: #555555">=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>):
    <span style="color: #006699; font-weight: bold">for</span> r <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>):
        plt<span style="color: #555555">.</span>subplot(<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>,p)
        plt<span style="color: #555555">.</span>scatter(SB[l],SB[r])
        p <span style="color: #555555">=</span> p<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_54_0.png" /></p>
<ul>
<li>3 . Normalization brings each column vector to have mean equal to zero which helps to visualize variance-covariance of samples.</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">normalization</span>(Vec):
    mn <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    vr <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    rng <span style="color: #555555">=</span> [<span style="color: #FF6600">0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    numVec <span style="color: #555555">=</span>  [[<span style="color: #FF6600">0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(Nbag)]<span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>)]
    <span style="color: #0099FF; font-style: italic">#Find mean and range (Maximum-minimum) of each vector</span>
    <span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">5</span>): 
        mn[l] <span style="color: #555555">=</span> np<span style="color: #555555">.</span>mean(Vec[l])
        vr[l] <span style="color: #555555">=</span> np<span style="color: #555555">.</span>var(Vec[l])
        <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(Nbag):
            numVec[l][k] <span style="color: #555555">=</span> (SampleBag[k][l] <span style="color: #555555">-</span> mn[l])<span style="color: #555555">/</span>(math<span style="color: #555555">.</span>sqrt(vr[l]<span style="color: #555555">/</span><span style="color: #336666">float</span>(Nbag)))
            numVec <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(numVec)
    <span style="color: #006699; font-weight: bold">return</span> numVec
</pre></div>


<h5 id="1132a-variance-covariance-of-raw-samples">1.1.3.2.a. Variance-Covariance of Raw samples</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Vec <span style="color: #555555">=</span> vactorization(SampleBag)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>VCM_raw  <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cov(Vec)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;Variance-Covariance of raw sample&quot;</span>)
plt<span style="color: #555555">.</span>imshow(VCM_raw, interpolation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nearest&#39;</span>,\
     cmap<span style="color: #555555">=</span>plt<span style="color: #555555">.</span>cm<span style="color: #555555">.</span>hot, extent<span style="color: #555555">=</span>(<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>,<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>))
plt<span style="color: #555555">.</span>colorbar()
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_60_0.png" /></p>
<h5 id="1132b-variance-covariance-of-normalized-samples-crrelation-cofficients">1.1.3.2.b. Variance-Covariance of Normalized samples : Crrelation cofficients</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Vec <span style="color: #555555">=</span> vactorization(SampleBag)
numVec <span style="color: #555555">=</span> normalization(Vec)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>VCM_normalized <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cov(numVec)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;Variance-Covariance of normalized sample&quot;</span>)
plt<span style="color: #555555">.</span>imshow(VCM_normalized, interpolation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nearest&#39;</span>,\
         cmap<span style="color: #555555">=</span>plt<span style="color: #555555">.</span>cm<span style="color: #555555">.</span>hot, extent<span style="color: #555555">=</span>(<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>,<span style="color: #FF6600">0.5</span>,<span style="color: #FF6600">10.5</span>))
plt<span style="color: #555555">.</span>colorbar()
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_64_0.png" /></p>
<h3 id="1133-spring-constants">1.1.3.3. Spring Constants</h3>
<p>Matrix of spring constants is a symmetric tensor which can be given by square root of normalized correlation cofficients.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>K <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sqrt(VCM_normalized<span style="color: #555555">/</span><span style="color: #336666">max</span>(VCM_normalized[<span style="color: #FF6600">0</span>]))
K
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>array([[ 1.        ,  0.79287801,  0.66542652,  0.56166262,  0.45306335],
       [ 0.79287801,  1.        ,  0.84281867,  0.69757696,  0.57453966],
       [ 0.66542652,  0.84281867,  1.        ,  0.83777405,  0.68199933],
       [ 0.56166262,  0.69757696,  0.83777405,  1.        ,  0.80502696],
       [ 0.45306335,  0.57453966,  0.68199933,  0.80502696,  1.        ]])
</pre></div>


<hr />
<p>$\color{blue}{\text{Improved Action}}: \boxed{L =  D^{\dagger}KD}$ with K-matrix found above.</p>
<hr />
<h2 id="12-montecarlo-simulation">1.2 Montecarlo Simulation</h2>
<ul>
<li>One can calculate the most probable difference vector using Hybrid Monrtecarlo Algorithm.</li>
</ul>
<p>Total energy of the system of (N=100) coupled oscillator in integer space can be expressed as:</p>
<p>$$H =  \sum_{i=1}^{N} D^{\dagger}KD $$</p>
<p>Define some useful function for thermalization</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">action</span>(D):
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;D = distance matrix&#39;&#39;&#39;</span>
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;K = spring constant tensor&#39;&#39;&#39;</span>
    h <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(D,np<span style="color: #555555">.</span>dot(K,D))
    htr <span style="color: #555555">=</span> np<span style="color: #555555">.</span>trace(h)
    <span style="color: #006699; font-weight: bold">return</span> htr    
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">hot_start</span>():
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;N = total no of coupled oscillators in the system &#39;&#39;&#39;</span>
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;U = bag of N oscillators&#39;&#39;&#39;</span>
    U <span style="color: #555555">=</span> []
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        x <span style="color: #555555">=</span> sample_generator(Max)
        U<span style="color: #555555">.</span>append(x)
    <span style="color: #006699; font-weight: bold">return</span> U
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">cold_start</span>():
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;N = total no of coupled oscillators in the system &#39;&#39;&#39;</span>
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;U = bag of N oscillators&#39;&#39;&#39;</span>
    U <span style="color: #555555">=</span> []
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        x <span style="color: #555555">=</span> [<span style="color: #FF6600">1</span>,<span style="color: #FF6600">1</span>,<span style="color: #FF6600">1</span>,<span style="color: #FF6600">1</span>,<span style="color: #FF6600">1</span>]
        U<span style="color: #555555">.</span>append(x)
    <span style="color: #006699; font-weight: bold">return</span> U
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">hamiltonian</span>(U):
    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;H = total hamiltonian&#39;&#39;&#39;</span>
    H <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        D <span style="color: #555555">=</span>   distance_matrix(U[k])
        h <span style="color: #555555">=</span> action(D)
        H  <span style="color: #555555">=</span> H<span style="color: #555555">+</span>h
    <span style="color: #006699; font-weight: bold">return</span> H
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">pick_random_particle</span>(printkey):
    n <span style="color: #555555">=</span> random<span style="color: #555555">.</span>randint(<span style="color: #FF6600">0</span>, N<span style="color: #555555">-</span><span style="color: #FF6600">1</span>)
    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>: <span style="color: #336666">print</span> <span style="color: #CC3300">&quot;oscillator picked  at&quot;</span>,n
    <span style="color: #006699; font-weight: bold">return</span> n
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">value_shifter</span>(u,dx):
    u <span style="color: #555555">=</span> u <span style="color: #555555">+</span> dx
    <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #336666">len</span>(u)):
        <span style="color: #006699; font-weight: bold">if</span> u[k] <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0</span>:
            u[k] <span style="color: #555555">=</span> Max <span style="color: #555555">+</span> u[k]
        <span style="color: #006699; font-weight: bold">elif</span> u[k]<span style="color: #555555">&gt;</span><span style="color: #FF6600">69</span>:
            u[k] <span style="color: #555555">=</span> u[k]<span style="color: #555555">%</span>Max
    u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sort(u)        
    <span style="color: #006699; font-weight: bold">return</span> u
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>dv <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
Kb <span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>
T <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
N <span style="color: #555555">=</span> <span style="color: #FF6600">20</span>
</pre></div>


<hr />
<h3 id="121-thermalization">1.2.1 Thermalization</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">thermalize</span>(U,T,nruns,printkey):
    irun <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    h_stor <span style="color: #555555">=</span> [<span style="color: #FF6600">0.0</span> <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(nrun)]
    U_stor <span style="color: #555555">=</span> []
    count <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
    <span style="color: #006699; font-weight: bold">while</span> irun <span style="color: #555555">&lt;</span> nrun:
            h_old <span style="color: #555555">=</span> hamiltonian(U)

            n <span style="color: #555555">=</span> pick_random_particle(printkey)
            ov <span style="color: #555555">=</span> U[n] 
            dx <span style="color: #555555">=</span> random<span style="color: #555555">.</span>sample(<span style="color: #336666">range</span>(<span style="color: #555555">-</span>dv,dv), <span style="color: #FF6600">5</span>)
            U[n] <span style="color: #555555">=</span> value_shifter(U[n],dx)



            h_new <span style="color: #555555">=</span> hamiltonian(U)

            dh <span style="color: #555555">=</span> h_new <span style="color: #555555">-</span> h_old
            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span>  <span style="color: #CC3300">&quot;=========&quot;</span>, irun,<span style="color: #CC3300">&quot;==============&quot;</span> 

            <span style="color: #006699; font-weight: bold">if</span> dh <span style="color: #555555">&lt;</span> <span style="color: #FF6600">0</span>:
                    count <span style="color: #555555">=</span> count<span style="color: #555555">+</span><span style="color: #FF6600">1</span>  
                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>: <span style="color: #336666">print</span> irun, <span style="color: #CC3300">&quot;Energy decreased! It is accepted!&quot;</span>,dh
                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span><span style="color: #FF6600">3</span>:  <span style="color: #336666">print</span> <span style="color: #CC3300">&quot;change made at&quot;</span>,n,dx,<span style="color: #CC3300">&quot;Participant&quot;</span>,U[n]    
                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>: <span style="color: #336666">print</span> irun, <span style="color: #CC3300">&quot;old conf. = &quot;</span>, ov,<span style="color: #CC3300">&quot;replaced by&quot;</span>,U[n] 

                    h_stor[irun] <span style="color: #555555">=</span> h_new
                    U_stor<span style="color: #555555">.</span>append(U)

            <span style="color: #006699; font-weight: bold">else</span>:

                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span> irun, <span style="color: #CC3300">&quot;Energy increased!&quot;</span>,dh

                    frac <span style="color: #555555">=</span> math<span style="color: #555555">.</span>exp(<span style="color: #555555">-</span>dh<span style="color: #555555">/</span>(Kb<span style="color: #555555">*</span>T))
                    b <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">1.0</span>)

                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span> <span style="color: #CC3300">&quot;frac =&quot;</span>,frac,<span style="color: #CC3300">&quot;b =&quot;</span>,b

                    <span style="color: #006699; font-weight: bold">if</span>  b <span style="color: #555555">&lt;</span> frac:

                        <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span> irun, <span style="color: #CC3300">&quot;You Lucky&quot;</span>

                        h_stor[irun] <span style="color: #555555">=</span> h_new  
                        U_stor<span style="color: #555555">.</span>append(U)
                    <span style="color: #006699; font-weight: bold">else</span>:

                            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span> irun, <span style="color: #CC3300">&quot;Loser&quot;</span>
                            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span> <span style="color: #CC3300">&quot;config. restablished at&quot;</span>,\
                                     n, <span style="color: #CC3300">&quot;:&quot;</span>,U[n],<span style="color: #CC3300">&quot;by&quot;</span>,U[n]<span style="color: #555555">-</span>dx,<span style="color: #CC3300">&quot;which is old&quot;</span>,ov

                            U[n]  <span style="color: #555555">=</span> U[n] <span style="color: #555555">-</span> dx
                            h_stor[irun] <span style="color: #555555">=</span> h_old 




            <span style="color: #006699; font-weight: bold">if</span> U[n][<span style="color: #FF6600">0</span>] <span style="color: #555555">!=</span> ov[<span style="color: #FF6600">0</span>] :                 
                    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:
                         <span style="color: #336666">print</span> <span style="color: #CC3300">&quot;Warning! config changed at&quot;</span>,n,\
                                     <span style="color: #CC3300">&quot;:&quot;</span>, ov, <span style="color: #CC3300">&quot; replaced by&quot;</span>, U[n]        

            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span>  <span style="color: #CC3300">&quot;---------------info-closed----------------&quot;</span>   
            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span>  <span style="color: #CC3300">&quot;&quot;</span>                            
            <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">2</span>: <span style="color: #336666">print</span> irun, h_stor[irun]   

            irun <span style="color: #555555">=</span> irun <span style="color: #555555">+</span><span style="color: #FF6600">1</span>

    success <span style="color: #555555">=</span> (count<span style="color: #555555">/</span><span style="color: #336666">float</span>(nrun))<span style="color: #555555">*</span><span style="color: #FF6600">100</span>   
    <span style="color: #006699; font-weight: bold">if</span> printkey <span style="color: #555555">==</span> <span style="color: #FF6600">1</span>:<span style="color: #336666">print</span>  <span style="color: #CC3300">&quot;================================&quot;</span>         
    <span style="color: #336666">print</span>  <span style="color: #CC3300">&quot;Success=&quot;</span> ,success,<span style="color: #CC3300">&quot;%&quot;</span>
    <span style="color: #006699; font-weight: bold">return</span> h_stor,U_stor
</pre></div>


<h5 id="test-mode">Test mode</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>U <span style="color: #555555">=</span> hot_start()
<span style="color: #0099FF; font-style: italic">#U = cold_start()</span>
nrun <span style="color: #555555">=</span> <span style="color: #FF6600">5</span>
H_stor,U_stor <span style="color: #555555">=</span> thermalize(U,T,nrun,<span style="color: #FF6600">1</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>oscillator picked  at 4
================= 0 ====================
0 Energy increased! 14490.7437085
frac = 1.16815288879e-63 b = 0.635801285104
0 Loser
config. restablished at 4 : [ 4 30 51 55 57] by [ 9 25 42 48 59] which is old [ 9 25 46 50 53]
---------------info-closed----------------

oscillator picked  at 4
================= 1 ====================
1 Energy decreased! It is accepted! -7019.6507091
1 old conf. =  [ 9 25 42 48 59] replaced by [ 7 32 41 50 52]
Warning! config changed at 4 : [ 9 25 42 48 59]  replaced by [ 7 32 41 50 52]
---------------info-closed----------------

oscillator picked  at 15
================= 2 ====================
2 Energy increased! 3885.6261383
frac = 1.33333750064e-17 b = 0.413681262571
2 Loser
config. restablished at 15 : [30 44 56 61 62] by [38 42 52 67 65] which is old [38 42 57 62 65]
---------------info-closed----------------

oscillator picked  at 12
================= 3 ====================
3 Energy decreased! It is accepted! -351.113417797
3 old conf. =  [20 26 43 44 46] replaced by [14 19 35 35 41]
Warning! config changed at 12 : [20 26 43 44 46]  replaced by [14 19 35 35 41]
---------------info-closed----------------

oscillator picked  at 4
================= 4 ====================
4 Energy decreased! It is accepted! -788.430394958
4 old conf. =  [ 7 32 41 50 52] replaced by [16 27 45 50 60]
Warning! config changed at 4 : [ 7 32 41 50 52]  replaced by [16 27 45 50 60]
---------------info-closed----------------

===========================================
Success= 60.0 %
</pre></div>


<h5 id="thermal-mode">Thermal mode</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>U <span style="color: #555555">=</span> hot_start()
<span style="color: #0099FF; font-style: italic">#U = cold_start()</span>
nrun <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
H_stor,U_stor <span style="color: #555555">=</span> thermalize(U,T,nrun,<span style="color: #FF6600">0</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Success= 39.32 %
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>X <span style="color: #555555">=</span> np<span style="color: #555555">.</span>arange(<span style="color: #FF6600">0</span>,<span style="color: #336666">len</span>(H_stor),<span style="color: #FF6600">1</span>)
plt<span style="color: #555555">.</span>figure(<span style="color: #FF6600">1</span>)
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>plot(X,H_stor,<span style="color: #CC3300">&quot;-&quot;</span>)
plt<span style="color: #555555">.</span>show()           
</pre></div>


<p><img alt="png" src="../output_90_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span><span style="color: #FF6600">50</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>hist(H_stor,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;histogram of Energy&quot;</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_91_0.png" /></p>
<p>This provides sufficient evidence for system in thermal equilibrium.</p>
<h3 id="measurement-of-average-absolute-difference">Measurement of average  absolute difference</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">abs_diff</span>(x):
    diff <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(x[<span style="color: #FF6600">0</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">1</span>])<span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">2</span>])<span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">2</span>]\
                <span style="color: #555555">-</span>x[<span style="color: #FF6600">3</span>])<span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">3</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">4</span>])<span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">4</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>])
    <span style="color: #006699; font-weight: bold">return</span> diff
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>ln <span style="color: #555555">=</span> <span style="color: #336666">len</span>(U_stor)
total_abs_diff <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
Diff <span style="color: #555555">=</span> []
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(ln):
    U <span style="color: #555555">=</span> U_stor[k]
    <span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        x <span style="color: #555555">=</span> U[l]
        diff <span style="color: #555555">=</span> abs_diff(x)
        Diff<span style="color: #555555">.</span>append(diff)
        total_abs_diff <span style="color: #555555">=</span> total_abs_diff <span style="color: #555555">+</span> diff
average_abs_diff    <span style="color: #555555">=</span> total_abs_diff<span style="color: #555555">/</span><span style="color: #336666">float</span>(ln<span style="color: #555555">*</span>N) 
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>average_abs_diff 
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>65.200000000000003
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span><span style="color: #FF6600">50</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>hist(Diff,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;histogram of absolute difference&quot;</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_97_0.png" /></p>
<h3 id="measurement-of-root-mean-square-absolute-difference">Measurement of root mean square absolute difference</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rms_diff</span>(x):
    diff <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(<span style="color: #336666">abs</span>(x[<span style="color: #FF6600">0</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">1</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">2</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span>\
            <span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">2</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">3</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">3</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">4</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">4</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">return</span> diff
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>ln <span style="color: #555555">=</span> <span style="color: #336666">len</span>(U_stor)
total_rms_diff <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
rms_Diff <span style="color: #555555">=</span> []
<span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(ln):
    U <span style="color: #555555">=</span> U_stor[k]
    <span style="color: #006699; font-weight: bold">for</span> l <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(N):
        x <span style="color: #555555">=</span> U[l]
        diff <span style="color: #555555">=</span> rms_diff(x)
        rms_Diff<span style="color: #555555">.</span>append(diff)
        total_rms_diff <span style="color: #555555">=</span> total_abs_diff <span style="color: #555555">+</span> diff
rms_diff    <span style="color: #555555">=</span> total_rms_diff<span style="color: #555555">/</span><span style="color: #336666">float</span>(ln<span style="color: #555555">*</span>N) 
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>rms_diff  
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>65.200247173536098
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span><span style="color: #FF6600">50</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>hist(rms_Diff,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, \
            facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&quot;histogram of rms difference&quot;</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_102_0.png" /></p>
<hr />
<h2 id="13-interpretation">1.3. Interpretation</h2>
<h3 id="131-most-probable-samples-using-model-iii-constrained-by-rms-absolute-difference">1.3.1. Most Probable Samples using Model -III : constrained by rms absolute difference</h3>
<h4 id="1312-generation-of-many-samples-and-their-actions">1.3.1.2. Generation of many  samples and their actions</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">simulation_III</span>(N_sample,Max):
    Lstor <span style="color: #555555">=</span> []
    Xstor <span style="color: #555555">=</span> []
    k<span style="color: #555555">=</span> <span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">while</span> k <span style="color: #555555">&lt;</span> N_sample:
        x <span style="color: #555555">=</span> sample_generator(Max)
        D <span style="color: #555555">=</span>   distance_matrix(x)
        atn <span style="color: #555555">=</span> action(D)
        Xstor<span style="color: #555555">.</span>append(x)
        Lstor<span style="color: #555555">.</span>append(atn)
        k <span style="color: #555555">=</span> k<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">return</span> Xstor,Lstor     
</pre></div>


<h4 id="1313-histogram-plot-of-frequencies">1.3.1.3. Histogram Plot of frequencies</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>N_sample <span style="color: #555555">=</span> <span style="color: #FF6600">100000</span>
Xstor,Lstor <span style="color: #555555">=</span> simulation_III(N_sample,Max)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>num_bins <span style="color: #555555">=</span> <span style="color: #FF6600">50</span>
plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>hist(Lstor,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, \
                facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_110_0.png" /></p>
<h3 id="1314-generate-some-sample">1.3.1.4.  Generate some sample</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>sample_required <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>count <span style="color: #555555">=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">while</span> count <span style="color: #555555">&lt;</span> sample_required:
    x <span style="color: #555555">=</span> sample_generator(Max)
    rmsdiff <span style="color: #555555">=</span> math<span style="color: #555555">.</span>sqrt(<span style="color: #336666">abs</span>(x[<span style="color: #FF6600">0</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">1</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>\
                x[<span style="color: #FF6600">2</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">2</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">3</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">3</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">4</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">+</span><span style="color: #336666">abs</span>(x[<span style="color: #FF6600">4</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    D <span style="color: #555555">=</span>   distance_matrix(x)
    act <span style="color: #555555">=</span> action(D)
    <span style="color: #006699; font-weight: bold">if</span> act <span style="color: #555555">&gt;</span> <span style="color: #FF6600">20000</span> <span style="color: #000000; font-weight: bold">and</span> act <span style="color: #555555">&lt;</span> <span style="color: #FF6600">40000</span>:
        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;rms_diff constraint&#39;&#39;&#39;</span>
        <span style="color: #006699; font-weight: bold">if</span> rmsdiff <span style="color: #555555">&lt;</span> <span style="color: #FF6600">70</span> <span style="color: #000000; font-weight: bold">and</span> rmsdiff <span style="color: #555555">&gt;</span> <span style="color: #FF6600">50</span>: 
            count <span style="color: #555555">=</span> count<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
            <span style="color: #336666">print</span> <span style="color: #CC3300">&quot;rms test passed!&quot;</span>,x,act
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>rms test passed! [22 31 34 36 63] 23213.3113095
rms test passed! [ 7 13 35 39 50] 33691.0412054
rms test passed! [18 46 51 61 62] 31851.0262931
rms test passed! [ 1  5 24 25 48] 35954.8593645
rms test passed! [17 37 47 52 68] 37716.8213328
rms test passed! [ 4 40 46 48 56] 39837.2864565
rms test passed! [17 33 45 46 68] 36706.1095915
rms test passed! [ 7 19 29 30 60] 39387.868137
rms test passed! [21 46 58 62 67] 34223.4073232
rms test passed! [14 23 27 39 60] 32757.3684971
rms test passed! [23 25 37 54 68] 38547.9912041
rms test passed! [ 9 35 36 38 64] 37754.3796817
rms test passed! [ 1 10 12 21 51] 36992.1945171
rms test passed! [ 7 12 20 40 52] 37750.4521181
rms test passed! [ 4 11 21 24 47] 27705.7997514
rms test passed! [27 35 38 66 68] 34682.9450353
rms test passed! [ 6 21 24 41 55] 37746.4051962
rms test passed! [ 8 17 19 20 57] 33609.5413481
rms test passed! [18 37 53 60 63] 35902.0551094
rms test passed! [12 25 30 53 57] 37347.9295182
</pre></div>


<p>Take these samples and buy lottery! Enjoy!</p>
<h3 id="132-most-probable-samples-using-model-i-without-any-constraint-from-thermalization">1.3.2. Most Probable Samples using Model -I : without any constraint from thermalization</h3>
<h4 id="1321-calculation-of-action-in-each-sample">1.3.2.1. Calculation of action in each sample</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">action_I</span>(x):
    act <span style="color: #555555">=</span>  <span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>((x[<span style="color: #FF6600">0</span>] <span style="color: #555555">-</span>x[<span style="color: #FF6600">1</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (x[<span style="color: #FF6600">1</span>] <span style="color: #555555">-</span>x[<span style="color: #FF6600">2</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> (x[<span style="color: #FF6600">2</span>] <span style="color: #555555">-</span>x[<span style="color: #FF6600">3</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span>  <span style="color: #555555">+</span>(x[<span style="color: #FF6600">3</span>] <span style="color: #555555">-</span>x[<span style="color: #FF6600">4</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">return</span> act
</pre></div>


<h4 id="1322-generation-of-many-n_samples-samples-and-their-actions">1.3.2.2. Generation of many (N_samples) samples and their actions</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">simulation_I</span>(N_sample,Max):
    Lstor <span style="color: #555555">=</span> []
    Xstor <span style="color: #555555">=</span> []
    k <span style="color: #555555">=</span> <span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">while</span> k <span style="color: #555555">&lt;</span> N_sample:
        x <span style="color: #555555">=</span> sample_generator(Max)
        atn <span style="color: #555555">=</span> action_I(x)
        Xstor<span style="color: #555555">.</span>append(x)
        Lstor<span style="color: #555555">.</span>append(atn)
        k <span style="color: #555555">=</span> k<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
    <span style="color: #006699; font-weight: bold">return</span> Xstor,Lstor    
</pre></div>


<h4 id="1323-histogram-plot-of-frequencies">1.3.2.3. Histogram Plot of frequencies</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>N_sample <span style="color: #555555">=</span> <span style="color: #FF6600">10000</span>
Xstor,Lstor <span style="color: #555555">=</span> simulation_I(N_sample,Max)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>grid()
plt<span style="color: #555555">.</span>hist(Lstor,num_bins, normed<span style="color: #555555">=</span> <span style="color: #FF6600">1.0</span>, facecolor<span style="color: #555555">=</span><span style="color: #CC3300">&#39;green&#39;</span>, alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.5</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_122_0.png" /></p>
<h3 id="1324-generate-some-sample">1.3.2.4.  Generate some sample</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>sample_required <span style="color: #555555">=</span> <span style="color: #FF6600">100</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>k <span style="color: #555555">=</span> <span style="color: #FF6600">1</span>
<span style="color: #006699; font-weight: bold">while</span> k <span style="color: #555555">&lt;</span> sample_required:
    x <span style="color: #555555">=</span> sample_generator(Max)
    act <span style="color: #555555">=</span> action_I(x)
    <span style="color: #006699; font-weight: bold">if</span> act <span style="color: #555555">&gt;</span> <span style="color: #FF6600">250</span> <span style="color: #000000; font-weight: bold">and</span> act <span style="color: #555555">&lt;</span> <span style="color: #FF6600">350</span>:
        <span style="color: #336666">print</span> x,act
        k <span style="color: #555555">=</span> k<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[14 27 29 43 56] 269.0
[11 21 42 48 54] 306.5
[ 3  6  9 13 35] 259.0
[ 6 20 33 37 51] 288.5
[ 8 24 27 34 52] 319.0
[10 18 22 34 55] 332.5
[ 2 14 19 34 49] 309.5
[10 23 31 35 52] 269.0
[17 37 49 59 63] 330.0
[ 8 29 43 50 52] 345.0
[ 3 10 15 30 50] 349.5
[ 7 12 22 40 52] 296.5
[ 8 12 28 42 57] 346.5
[16 19 31 35 58] 349.0
[14 36 50 51 53] 342.5
[ 1  7 18 28 49] 349.0
[21 32 34 54 55] 263.0
[15 31 45 53 56] 262.5
[20 26 42 53 64] 267.0
[ 5 13 31 33 45] 268.0
[ 5  9 20 22 42] 270.5
[ 2 19 32 37 46] 282.0
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Take these samples <span style="color: #000000; font-weight: bold">and</span> buy lottery<span style="color: #AA0000; background-color: #FFAAAA">!</span> Enjoy<span style="color: #AA0000; background-color: #FFAAAA">!</span>
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../IdealGas/IdealGas/" class="btn btn-neutral float-right" title="Ideal Gas">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../GettingStarted/intro/" class="btn btn-neutral" title="Algorithms"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../GettingStarted/intro/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../IdealGas/IdealGas/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
