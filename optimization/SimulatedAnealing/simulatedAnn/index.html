
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Simulated Annealing - Tutorials in Statistical Physics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simulated-annealing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Tutorials in Statistical Physics" class="md-header-nav__button md-logo" aria-label="Tutorials in Statistical Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Tutorials in Statistical Physics
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Simulated Annealing
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tutorials in Statistical Physics" class="md-nav__button md-logo" aria-label="Tutorials in Statistical Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Tutorials in Statistical Physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../WhyComputationalPhysics/" class="md-nav__link">
      Why Computational Physics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/GettingStarted/intro/" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/GettingStarted/intro/" class="md-nav__link">
      Algorithms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/IdealGas/IdealGas/" class="md-nav__link">
      Ideal Gas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Oscillator/Oscillator/" class="md-nav__link">
      Harmonic Oscillator
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/IzingModel/Izing2D/" class="md-nav__link">
      Ising Model
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Percolation/percol/" class="md-nav__link">
      Percolation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/HardDisk/hd/" class="md-nav__link">
      Hard Disk
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Levy/levy/" class="md-nav__link">
      Quantum Monte Carlo
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/BEC/bec/" class="md-nav__link">
      Bose-Einstein Condensation
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Simulated Annealing
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Simulated Annealing
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-simulated-annealing" class="md-nav__link">
    Introduction to Simulated Annealing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-i-problem-set-up" class="md-nav__link">
    Part -I : Problem set up
  </a>
  
    <nav class="md-nav" aria-label="Part -I : Problem set up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#define-objective-function" class="md-nav__link">
    Define Objective function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-plot-of-surface-potential" class="md-nav__link">
    3D plot of surface potential
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#density-plot-of-surface-potential" class="md-nav__link">
    Density Plot of surface potential
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-ii-simulation" class="md-nav__link">
    Part - II : Simulation
  </a>
  
    <nav class="md-nav" aria-label="Part - II : Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    Task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../PathIntegral/Intro/Intro/" class="md-nav__link">
      Path Integral
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../References/" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-simulated-annealing" class="md-nav__link">
    Introduction to Simulated Annealing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-i-problem-set-up" class="md-nav__link">
    Part -I : Problem set up
  </a>
  
    <nav class="md-nav" aria-label="Part -I : Problem set up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#define-objective-function" class="md-nav__link">
    Define Objective function
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3d-plot-of-surface-potential" class="md-nav__link">
    3D plot of surface potential
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#density-plot-of-surface-potential" class="md-nav__link">
    Density Plot of surface potential
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-ii-simulation" class="md-nav__link">
    Part - II : Simulation
  </a>
  
    <nav class="md-nav" aria-label="Part - II : Simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task" class="md-nav__link">
    Task
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <hr />
<h1 id="simulated-annealing">Simulated Annealing</h1>
<p>By Dibakar Sigdel  :   Date April-26-2016</p>
<h3 id="introduction-to-simulated-annealing">Introduction to Simulated Annealing</h3>
<p>Simulated annealing [1] copies a phenomenon in nature--the annealing of solids--to optimize a complex system. Annealing refers to heating a solid and then cooling it slowly. Atoms then assume a nearly globally minimum energy state. In 1953 Metropolis created an algorithm to simulate the annealing process. The algorithm simulates a small random displacement of an atom that results in a change in energy. If the change in energy is negative, the energy state of the new configuration is lower and the new configuration is accepted. If the change in energy is positive, the new configuration has a higher energy state; however, it may still be accepted according to the Boltzmann probability factor:</p>
<p>$$P  = exp(\frac{-\triangle E}{K_{b}T})$$</p>
<p>where $K_b$ is the Boltzmann constant and T is the current temperature. By examining this equation we should note two things: the probability is proportional to temperature--as the solid cools, the probability gets smaller; and inversely proportional to --as the change in energy is larger the probability of accepting the change gets smaller. </p>
<ul>
<li>Pictorial Algorithm</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">IPython.display</span> <span style="color: #006699; font-weight: bold">import</span> Image
Image(filename<span style="color: #555555">=</span><span style="color: #CC3300">&#39;sim.png&#39;</span>)
</code></pre></div>


<p><img alt="png" src="../output_8_0.png" /></p>
<p>When applied to engineering design, an analogy is made between energy and the objective function. The design is started at a high “temperature”, where it has a high objective (we assume we are minimizing). Random perturbations are then made to the design. If the objective is lower, the new design is made the current design; if it is higher, it may still be accepted according the probability given by the Boltzmann factor. The Boltzmann probability is compared to a random number drawn from a uniform distribution between 0 and 1; if the random number is smaller than the Boltzmann probability, the configuration is accepted. This allows the algorithm to escape local minima. </p>
<ul>
<li>Required Libraries</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">math</span>
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #006699; font-weight: bold">import</span> Axes3D
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">matplotlib</span> <span style="color: #006699; font-weight: bold">import</span> cm
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.ticker</span> <span style="color: #006699; font-weight: bold">import</span> LinearLocator, FormatStrFormatter
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #555555">%</span>matplotlib inline
</code></pre></div>


<hr />
<h2 id="part-i-problem-set-up">Part -I : Problem set up</h2>
<h4 id="define-objective-function">Define Objective function</h4>
<p>Consider a  2D system where atoms are interacting with the surface of a material. A model for the interaction potential is</p>
<p>$$V(x) = V_{o}\left \lbrace nA + \sum_{i=1}^{n}[x_{i}^{2} - A \cos(2\pi x_{i})]\right \rbrace $$</p>
<p>where $n = 2$: two dimensions.</p>
<p>A = 10; $V_{o}$ is in energy unit.</p>
<p>Consider the section $x_{1,2} \in [-4,4]$ of the surface.</p>
<hr />
<ul>
<li>Surface Potential function</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">potential</span>(x1,x2):
    obj <span style="color: #555555">=</span> (<span style="color: #FF6600">2</span><span style="color: #555555">*</span><span style="color: #FF6600">10.0</span>) <span style="color: #555555">+</span> x1<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> x2<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span> (<span style="color: #FF6600">10.0</span>)<span style="color: #555555">*</span>(math<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span><span style="color: #FF6600">3.1415</span><span style="color: #555555">*</span>x1) <span style="color: #555555">-</span> math<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span><span style="color: #FF6600">3.1415</span><span style="color: #555555">*</span>x2))
    <span style="color: #006699; font-weight: bold">return</span> obj
</code></pre></div>


<ul>
<li>Design variables for mesh points</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>ix <span style="color: #555555">=</span> np<span style="color: #555555">.</span>arange(<span style="color: #555555">-</span><span style="color: #FF6600">4.0</span>, <span style="color: #FF6600">4.0</span>, <span style="color: #FF6600">0.05</span>)
iy <span style="color: #555555">=</span> np<span style="color: #555555">.</span>arange(<span style="color: #555555">-</span><span style="color: #FF6600">4.0</span>, <span style="color: #FF6600">4.0</span>, <span style="color: #FF6600">0.05</span>)
X,Y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>meshgrid(ix, iy)
fz <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(X<span style="color: #555555">.</span>shape)
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(X<span style="color: #555555">.</span>shape[<span style="color: #FF6600">0</span>]):
    <span style="color: #006699; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(X<span style="color: #555555">.</span>shape[<span style="color: #FF6600">1</span>]):
        fz[i][j] <span style="color: #555555">=</span> potential(X[i][j],Y[i][j])   
</code></pre></div>


<h4 id="3d-plot-of-surface-potential">3D plot of surface potential</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>fig <span style="color: #555555">=</span> plt<span style="color: #555555">.</span>figure(figsize<span style="color: #555555">=</span>(<span style="color: #FF6600">14</span>, <span style="color: #FF6600">10</span>))
ax <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>gca(projection<span style="color: #555555">=</span><span style="color: #CC3300">&#39;3d&#39;</span>)
surf <span style="color: #555555">=</span> ax<span style="color: #555555">.</span>plot_surface(X, Y, fz, rstride<span style="color: #555555">=</span><span style="color: #FF6600">1</span>, cstride<span style="color: #555555">=</span><span style="color: #FF6600">1</span>, cmap<span style="color: #555555">=</span>cm<span style="color: #555555">.</span>coolwarm,
                       linewidth<span style="color: #555555">=</span><span style="color: #FF6600">0</span>, antialiased<span style="color: #555555">=</span><span style="color: #006699; font-weight: bold">False</span>)
ax<span style="color: #555555">.</span>set_zlim(<span style="color: #555555">-</span><span style="color: #FF6600">0.01</span>, <span style="color: #FF6600">60.01</span>)
ax<span style="color: #555555">.</span>zaxis<span style="color: #555555">.</span>set_major_locator(LinearLocator(<span style="color: #FF6600">10</span>))
ax<span style="color: #555555">.</span>zaxis<span style="color: #555555">.</span>set_major_formatter(FormatStrFormatter(<span style="color: #CC3300">&#39;</span><span style="color: #AA0000">%.02f</span><span style="color: #CC3300">&#39;</span>))
fig<span style="color: #555555">.</span>colorbar(surf, shrink<span style="color: #555555">=</span><span style="color: #FF6600">0.5</span>, aspect<span style="color: #555555">=</span><span style="color: #FF6600">5</span>)
plt<span style="color: #555555">.</span>show()
</code></pre></div>


<p><img alt="png" src="../output_24_0.png" /></p>
<h4 id="density-plot-of-surface-potential">Density Plot of surface potential</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>plt<span style="color: #555555">.</span>figure(figsize<span style="color: #555555">=</span>(<span style="color: #FF6600">12</span>, <span style="color: #FF6600">8</span>))
<span style="color: #0099FF; font-style: italic"># Specify contour lines</span>
CS <span style="color: #555555">=</span> plt<span style="color: #555555">.</span>contour(x1m, x2m, fm)<span style="color: #0099FF; font-style: italic">#,lines)</span>
<span style="color: #0099FF; font-style: italic"># Label contours</span>
plt<span style="color: #555555">.</span>clabel(CS, inline<span style="color: #555555">=</span><span style="color: #FF6600">1</span>, fontsize<span style="color: #555555">=</span><span style="color: #FF6600">10</span>)
<span style="color: #0099FF; font-style: italic"># Add some text to the plot</span>
plt<span style="color: #555555">.</span>title(<span style="color: #CC3300">&#39;Density plot of surface potential&#39;</span>)
plt<span style="color: #555555">.</span>xlabel(<span style="color: #CC3300">&#39;x1&#39;</span>)
plt<span style="color: #555555">.</span>ylabel(<span style="color: #CC3300">&#39;x2&#39;</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.text.Text at 0x12e704410&gt;
</code></pre></div>


<p><img alt="png" src="../output_26_1.png" /></p>
<hr />
<h2 id="part-ii-simulation">Part - II : Simulation</h2>
<h4 id="task">Task</h4>
<p>Put $N = 1000$ atoms on the surface. Compute a configuration $X_{o} = {x_{1},...,x_{N}}$ of minial potential energy $E[X_{o}]$ using simulated annealing. Apply Bose statistics, any number of atoms may occupy a local minimum $\vec{x}_{min}$.</p>
<hr />
<ul>
<li>Simulation setting</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic"># Start location</span>
x_start <span style="color: #555555">=</span> [<span style="color: #FF6600">0.5</span>, <span style="color: #555555">-</span><span style="color: #FF6600">0.5</span>]
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic">#Number of particles</span>
N <span style="color: #555555">=</span><span style="color: #FF6600">1000</span>
<span style="color: #0099FF; font-style: italic"># Number of cycles</span>
n <span style="color: #555555">=</span> <span style="color: #FF6600">1000</span>
<span style="color: #0099FF; font-style: italic"># Number of trials per cycle</span>
m <span style="color: #555555">=</span> <span style="color: #FF6600">500</span>
<span style="color: #0099FF; font-style: italic"># Number of accepted solutions</span>
na <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
<span style="color: #0099FF; font-style: italic"># Probability of accepting worse solution at the start</span>
p1 <span style="color: #555555">=</span> <span style="color: #FF6600">0.7</span>
<span style="color: #0099FF; font-style: italic"># Probability of accepting worse solution at the end</span>
p50 <span style="color: #555555">=</span> <span style="color: #FF6600">0.001</span>
<span style="color: #0099FF; font-style: italic"># Initial temperature</span>
t1 <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">1.0</span><span style="color: #555555">/</span>math<span style="color: #555555">.</span>log(p1)
<span style="color: #0099FF; font-style: italic"># Final temperature</span>
t50 <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">1.0</span><span style="color: #555555">/</span>math<span style="color: #555555">.</span>log(p50)
<span style="color: #0099FF; font-style: italic"># Fractional reduction every cycle</span>
frac <span style="color: #555555">=</span> (t50<span style="color: #555555">/</span>t1)<span style="color: #555555">**</span>(<span style="color: #FF6600">1.0</span><span style="color: #555555">/</span>(n<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>))
<span style="color: #0099FF; font-style: italic"># Initialize x</span>
x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros((n<span style="color: #555555">+</span><span style="color: #FF6600">1</span>,<span style="color: #FF6600">2</span>))
x[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> x_start
xi <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(<span style="color: #FF6600">2</span>)
xi <span style="color: #555555">=</span> x_start
na <span style="color: #555555">=</span> na <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span>
<span style="color: #0099FF; font-style: italic"># Current best results so far</span>
xc <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(<span style="color: #FF6600">2</span>)
xc <span style="color: #555555">=</span> x[<span style="color: #FF6600">0</span>]
fc <span style="color: #555555">=</span> potential(xi[<span style="color: #FF6600">0</span>],xi[<span style="color: #FF6600">1</span>])
fs <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros(n<span style="color: #555555">+</span><span style="color: #FF6600">1</span>)
fs[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> fc
<span style="color: #0099FF; font-style: italic"># Current temperature</span>
t <span style="color: #555555">=</span> t1
<span style="color: #0099FF; font-style: italic"># DeltaE Average</span>
DeltaE_avg <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
</code></pre></div>


<ul>
<li>Simulation</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(n):
    <span style="color: #0099FF; font-style: italic">#print &#39;Cycle: &#39; + str(i) + &#39; with Temperature: &#39; + str(t)</span>
    <span style="color: #006699; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(m):
        <span style="color: #0099FF; font-style: italic"># Generate new trial points</span>
        xi[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> xc[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">-</span> <span style="color: #FF6600">0.5</span>
        xi[<span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> xc[<span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> random<span style="color: #555555">.</span>random() <span style="color: #555555">-</span> <span style="color: #FF6600">0.5</span>
        <span style="color: #0099FF; font-style: italic"># Clip to upper and lower bounds</span>
        xi[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #336666">max</span>(<span style="color: #336666">min</span>(xi[<span style="color: #FF6600">0</span>],<span style="color: #FF6600">1.0</span>),<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>)
        xi[<span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #336666">max</span>(<span style="color: #336666">min</span>(xi[<span style="color: #FF6600">1</span>],<span style="color: #FF6600">1.0</span>),<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>)
        DeltaE <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(f(xi)<span style="color: #555555">-</span>fc)
        <span style="color: #006699; font-weight: bold">if</span> (potential(xi[<span style="color: #FF6600">0</span>],xi[<span style="color: #FF6600">1</span>])<span style="color: #555555">&gt;</span>fc):
            <span style="color: #0099FF; font-style: italic"># Initialize DeltaE_avg if a worse solution was found</span>
            <span style="color: #0099FF; font-style: italic">#   on the first iteration</span>
            <span style="color: #006699; font-weight: bold">if</span> (i<span style="color: #555555">==</span><span style="color: #FF6600">0</span> <span style="color: #000000; font-weight: bold">and</span> j<span style="color: #555555">==</span><span style="color: #FF6600">0</span>): DeltaE_avg <span style="color: #555555">=</span> DeltaE
            <span style="color: #0099FF; font-style: italic"># objective function is worse</span>
            <span style="color: #0099FF; font-style: italic"># generate probability of acceptance</span>
            p <span style="color: #555555">=</span> math<span style="color: #555555">.</span>exp(<span style="color: #555555">-</span>DeltaE<span style="color: #555555">/</span>(DeltaE_avg <span style="color: #555555">*</span> t))
            <span style="color: #0099FF; font-style: italic"># determine whether to accept worse point</span>
            <span style="color: #006699; font-weight: bold">if</span> (random<span style="color: #555555">.</span>random()<span style="color: #555555">&lt;</span>p):
                <span style="color: #0099FF; font-style: italic"># accept the worse solution</span>
                accept <span style="color: #555555">=</span> <span style="color: #006699; font-weight: bold">True</span>
            <span style="color: #006699; font-weight: bold">else</span>:
                <span style="color: #0099FF; font-style: italic"># don&#39;t accept the worse solution</span>
                accept <span style="color: #555555">=</span> <span style="color: #006699; font-weight: bold">False</span>
        <span style="color: #006699; font-weight: bold">else</span>:
            <span style="color: #0099FF; font-style: italic"># objective function is lower, automatically accept</span>
            accept <span style="color: #555555">=</span> <span style="color: #006699; font-weight: bold">True</span>
        <span style="color: #006699; font-weight: bold">if</span> (accept<span style="color: #555555">==</span><span style="color: #006699; font-weight: bold">True</span>):
            <span style="color: #0099FF; font-style: italic"># update currently accepted solution</span>
            xc[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> xi[<span style="color: #FF6600">0</span>]
            xc[<span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> xi[<span style="color: #FF6600">1</span>]
            fc <span style="color: #555555">=</span> potential(xc[<span style="color: #FF6600">0</span>],xc[<span style="color: #FF6600">1</span>])
            <span style="color: #0099FF; font-style: italic"># increment number of accepted solutions</span>
            na <span style="color: #555555">=</span> na <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span>
            <span style="color: #0099FF; font-style: italic"># update DeltaE_avg</span>
            DeltaE_avg <span style="color: #555555">=</span> (DeltaE_avg <span style="color: #555555">*</span> (na<span style="color: #555555">-</span><span style="color: #FF6600">1.0</span>) <span style="color: #555555">+</span>  DeltaE) <span style="color: #555555">/</span> na
    <span style="color: #0099FF; font-style: italic"># Record the best x values at the end of every cycle</span>
    x[i<span style="color: #555555">+</span><span style="color: #FF6600">1</span>][<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> xc[<span style="color: #FF6600">0</span>]
    x[i<span style="color: #555555">+</span><span style="color: #FF6600">1</span>][<span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> xc[<span style="color: #FF6600">1</span>]
    fs[i<span style="color: #555555">+</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> fc
    <span style="color: #0099FF; font-style: italic"># Lower the temperature for next cycle</span>
    t <span style="color: #555555">=</span> frac <span style="color: #555555">*</span> t

<span style="color: #0099FF; font-style: italic"># print solution</span>
<span style="color: #336666">print</span> <span style="color: #CC3300">&#39;Best solution: &#39;</span> <span style="color: #555555">+</span> <span style="color: #336666">str</span>(xc)
<span style="color: #336666">print</span> <span style="color: #CC3300">&#39;Best objective: &#39;</span> <span style="color: #555555">+</span> <span style="color: #336666">str</span>(fc)
plt<span style="color: #555555">.</span>figure(figsize<span style="color: #555555">=</span>(<span style="color: #FF6600">10</span>, <span style="color: #FF6600">8</span>))
plt<span style="color: #555555">.</span>plot(x[:,<span style="color: #FF6600">0</span>],x[:,<span style="color: #FF6600">1</span>],<span style="color: #CC3300">&#39;y-o&#39;</span>)
<span style="color: #0099FF; font-style: italic">#plt.savefig(&#39;contour.png&#39;)</span>

fig <span style="color: #555555">=</span> plt<span style="color: #555555">.</span>figure(figsize<span style="color: #555555">=</span>(<span style="color: #FF6600">10</span>, <span style="color: #FF6600">8</span>))
ax1 <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>add_subplot(<span style="color: #FF6600">211</span>)
ax1<span style="color: #555555">.</span>plot(fs,<span style="color: #CC3300">&#39;r.-&#39;</span>)
ax1<span style="color: #555555">.</span>legend([<span style="color: #CC3300">&#39;Objective&#39;</span>])
ax2 <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>add_subplot(<span style="color: #FF6600">212</span>)
ax2<span style="color: #555555">.</span>plot(x[:,<span style="color: #FF6600">0</span>],<span style="color: #CC3300">&#39;b.-&#39;</span>)
ax2<span style="color: #555555">.</span>plot(x[:,<span style="color: #FF6600">1</span>],<span style="color: #CC3300">&#39;g--&#39;</span>)
ax2<span style="color: #555555">.</span>legend([<span style="color: #CC3300">&#39;x1&#39;</span>,<span style="color: #CC3300">&#39;x2&#39;</span>])

<span style="color: #0099FF; font-style: italic"># Save the figure as a PNG</span>
<span style="color: #0099FF; font-style: italic">#plt.savefig(&#39;iterations.png&#39;)</span>

plt<span style="color: #555555">.</span>show()
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Best solution: [ 0.91536557 -0.66902677]
Best objective: 7.79514624035
</code></pre></div>


<p><img alt="png" src="../output_36_1.png" /></p>
<p><img alt="png" src="../output_36_2.png" /></p>
<ul>
<li>Repeat this for 1000 particles</li>
</ul>
<hr />
<h3 id="references">References</h3>
<p>1 . Simulated Annealing Tutorial http://apmonitor.com/me575/index.php/Main/SimulatedAnnealing</p>
<p>2 . The Simulated Annealing Algorithm http://katrinaeg.com/simulated-annealing.html</p>
<p>3 . Simulated Annealing for beginners  http://www.theprojectspot.com/tutorial-post/simulated-annealing-algorithm-for-beginners/6</p>
<p>4 . Simulated Annealing: http://csg.sph.umich.edu/abecasis/class/2006/615.19.pdf</p>
<p>5 . Simulated Annealing : http://mathworld.wolfram.com/SimulatedAnnealing.html</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../../Montecarlo/BEC/bec/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Bose-Einstein Condensation
              </div>
            </div>
          </a>
        
        
          <a href="../../../PathIntegral/Intro/Intro/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Path Integral
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>