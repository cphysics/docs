<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Optimization - Computational Physics</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Optimization";
    var mkdocs_page_input_path = "optimization/intro/Optimization.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Computational Physics</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Getting started</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/anaconda/">Guide to starting Python</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/lib/">Guide to Python Libraries</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/env/">Setting up Python Environment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/jupyter/">Installing Jupyter Notebook</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/git/">How to Git</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Python Programming</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../prog/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../DataStructure/ds/">DataStructure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../LoopsConditions/lnc.md">Loops and Conditions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Fern/fern/">Project Fern</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Diffusion/Diffusion/">Project Diffusion</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../FunctionClass/fnc/">Functions and Class</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Ncharges/Ncharges/">Project N-charges</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Rwalk/Rwalk/">Project Random Walk</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Numerical Methods</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/intro/Numerical-Methods/">Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/special-function/Special-Functions/">Special Functions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Diffusion/Diffusion/">Diffusion</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Ncharges/Ncharges/">Ncharges</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../NumericalMethods/Laplace/laplace/">Laplace</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Monte Carlo Simulation</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/GettingStarted/intro/">Getting Started Monte Carlo Simulation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/GettingStarted/intro/">Algorithms in Monte Carlo Simulation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/RandomWalk/Rwalk/">Random Walk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/Lotto/lotto/">Lottary Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/IdealGas/IdealGas/">Ideal Gas</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/Oscillator/Oscillator/">Harmonic Oscillator</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/IzingModel/Izing2D/">Ising Model</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/Percolation/percol/">Percolation</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/HardDisk/hd/">Hard Disk</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/Levy/levy/">Quantum Monte Carlo</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Montecarlo/BEC/bec/">Bose-Einstein Condensation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Optimization</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Optimization
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#scipy-optimization-source">
      Scipy Optimization Source
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#gradient-descient">Gradient Descient</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#plot-surfaces">Plot Surfaces</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#plot-concors">Plot Concors</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#find-minimum">Find Minimum</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#abritrary-surface-source">Abritrary Surface source</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#plot-surface">Plot Surface</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#plot-contor">Plot Contor</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#scipy-optimization">Scipy Optimization</a>
        </li>
    
    </ul>
  </li>

      

  <li class="toctree-l2">
    <a href="#newtons-conjugate-gradient-method">
      Newton's Conjugate Gradient Method
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2">
    <ul class="subnav-l2 toc-hidden">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#references">References</a>
        </li>
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../SimulatedAnealing/simulatedAnn/">Simulated Annealing</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Path Integral</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../PathIntegral/Intro/Intro/">Getting Started with Path Integral</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Fractals and Chaos</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Projects/Fern/fern/">Fern</a>
  </li>
        
      </ul>
    </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../References/">References</a>
  </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Computational Physics</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Optimization &raquo;</li>
        
      
    
    <li>Optimization</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="scipy-optimization-source">Scipy Optimization <a href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">Source</a></h2>
<p>SciPy optimize provides functions for minimizing (or maximizing) objective functions, possibly subject to constraints. It includes solvers for nonlinear problems (with support for both local and global optimization algorithms), linear programing, constrained and nonlinear least-squares, root finding and curve fitting.</p>
<ol>
<li>Scalar Functions Optimization</li>
<li>Local (Multivariate) Optimization</li>
<li>Global Optimization</li>
<li>Least-squares and Curve Fitting</li>
<li>Root finding</li>
</ol>
<h3 id="gradient-descient">Gradient Descient</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy.linalg</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">la</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">scipy.optimize</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sopt</span>

<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">pt</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #006699; font-weight: bold">import</span> axes3d
<span style="color: #555555">%</span>matplotlib inline
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
sns<span style="color: #555555">.</span>set()
</pre></div>


<p>Spherical Surface : 
$$F(x,y) = x^{2} + y^{2}$$</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">sphere</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">df_sphere</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>], <span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]])
</pre></div>


<h3 id="plot-surfaces">Plot Surfaces</h3>
<ul>
<li>Sphere</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>fig <span style="color: #555555">=</span> pt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">8</span>,<span style="color: #FF6600">8</span>])
ax <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>gca(projection<span style="color: #555555">=</span><span style="color: #CC3300">&quot;3d&quot;</span>)

xmesh, ymesh <span style="color: #555555">=</span> np<span style="color: #555555">.</span>mgrid[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50j</span>,<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50j</span>]
fmesh <span style="color: #555555">=</span> sphere(np<span style="color: #555555">.</span>array([xmesh, ymesh]))
ax<span style="color: #555555">.</span>plot_surface(xmesh, ymesh, fmesh)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;mpl_toolkits.mplot3d.art3d.Poly3DCollection at 0x1a18961550&amp;gt;
</pre></div>


<p><img alt="png" src="../output_9_1.png" /></p>
<h3 id="plot-concors">Plot Concors</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh,<span style="color: #FF6600">20</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;matplotlib.contour.QuadContourSet at 0x7f0bfe84f7b8&amp;gt;
</pre></div>


<p><img alt="png" src="../output_11_1.png" /></p>
<h3 id="find-minimum">Find Minimum</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>guesses <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #FF6600">2</span>,<span style="color: #FF6600">2</span>])]
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">10000</span>):
    x <span style="color: #555555">=</span> guesses[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    s <span style="color: #555555">=</span> <span style="color: #555555">-</span>df_sphere(x)
    alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.001</span>

    next_guess <span style="color: #555555">=</span> x <span style="color: #555555">+</span> alpha <span style="color: #555555">*</span> s
    guesses<span style="color: #555555">.</span>append(next_guess)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>guesses[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">10</span>]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[array([2, 2]),
 array([1.996, 1.996]),
 array([1.992008, 1.992008]),
 array([1.98802398, 1.98802398]),
 array([1.98404794, 1.98404794]),
 array([1.98007984, 1.98007984]),
 array([1.97611968, 1.97611968]),
 array([1.97216744, 1.97216744]),
 array([1.96822311, 1.96822311]),
 array([1.96428666, 1.96428666])]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh, <span style="color: #FF6600">10</span>)
it_array <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(guesses)
pt<span style="color: #555555">.</span>plot(it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">0</span>], it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">1</span>], <span style="color: #CC3300">&quot;o&quot;</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[&amp;lt;matplotlib.lines.Line2D at 0x7f0bfea38828&amp;gt;]
</pre></div>


<p><img alt="png" src="../output_15_1.png" /></p>
<h3 id="abritrary-surface-source">Abritrary Surface <a href="https://en.wikipedia.org/wiki/Gradient_descent">source</a></h3>
<p><img alt="img" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1ffee4fb42387d27e4a1e4d37d28239ff3b672fb" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">surface</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span>np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">df_surface</span>(x):

    u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)
    u_x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]
    u_y <span style="color: #555555">=</span> <span style="color: #555555">-</span>np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span><span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]

    v <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))
    v_x <span style="color: #555555">=</span> <span style="color: #555555">-</span>np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))<span style="color: #555555">*</span><span style="color: #FF6600">2.0</span>
    v_y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))<span style="color: #555555">*</span>np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>])                                              

    df_x <span style="color: #555555">=</span> u_x<span style="color: #555555">*</span>v <span style="color: #555555">+</span> u<span style="color: #555555">*</span>v_x
    df_y <span style="color: #555555">=</span> u_y<span style="color: #555555">*</span>v <span style="color: #555555">+</span> u<span style="color: #555555">*</span>v_y

    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>array([df_x,df_y])
</pre></div>


<h3 id="plot-surface">Plot Surface</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>fig <span style="color: #555555">=</span> pt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">8</span>,<span style="color: #FF6600">8</span>])
ax <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>gca(projection<span style="color: #555555">=</span><span style="color: #CC3300">&quot;3d&quot;</span>)

xmesh, ymesh <span style="color: #555555">=</span> np<span style="color: #555555">.</span>mgrid[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50j</span>,<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50j</span>]
fmesh <span style="color: #555555">=</span> surface(np<span style="color: #555555">.</span>array([xmesh, ymesh]))
ax<span style="color: #555555">.</span>plot_surface(xmesh, ymesh, fmesh)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;mpl_toolkits.mplot3d.art3d.Poly3DCollection at 0x7f0bfea68cc0&amp;gt;
</pre></div>


<p><img alt="png" src="../output_20_1.png" /></p>
<h3 id="plot-contor">Plot Contor</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh,<span style="color: #FF6600">20</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>&amp;lt;matplotlib.contour.QuadContourSet at 0x7f0bfeb2d390&amp;gt;
</pre></div>


<p><img alt="png" src="../output_22_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>guesses <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #555555">-</span><span style="color: #FF6600">0.25</span>,<span style="color: #FF6600">0.5</span>])]
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">100000</span>):
    x <span style="color: #555555">=</span> guesses[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    s <span style="color: #555555">=</span> <span style="color: #555555">-</span>df_surface(x)
    alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.0001</span>

    next_guess <span style="color: #555555">=</span> x <span style="color: #555555">+</span> alpha <span style="color: #555555">*</span> s
    guesses<span style="color: #555555">.</span>append(next_guess)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>guesses[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">10</span>]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[array([-0.25,  0.5 ]),
 array([-0.24995774,  0.4999897 ]),
 array([-0.24991547,  0.49997941]),
 array([-0.24987321,  0.49996911]),
 array([-0.24983095,  0.49995882]),
 array([-0.24978869,  0.49994853]),
 array([-0.24974643,  0.49993824]),
 array([-0.24970417,  0.49992795]),
 array([-0.24966191,  0.49991766]),
 array([-0.24961965,  0.49990738])]
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh, <span style="color: #FF6600">10</span>)
it_array <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(guesses)
pt<span style="color: #555555">.</span>plot(it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">0</span>], it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">1</span>], <span style="color: #CC3300">&quot;o&quot;</span>)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>[&amp;lt;matplotlib.lines.Line2D at 0x7f0bfdcb7e80&amp;gt;]
</pre></div>


<p><img alt="png" src="../output_25_1.png" /></p>
<h3 id="scipy-optimization">Scipy Optimization</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">scipy.optimize</span> <span style="color: #006699; font-weight: bold">import</span> minimize
</pre></div>


<ul>
<li>Sphere</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>x0 <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])]
res <span style="color: #555555">=</span> minimize(sphere, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nelder-mead&#39;</span>,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #336666">True</span>})
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 73
         Function evaluations: 137
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>res
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span> final_simplex: (array([[-1.53149299e-09,  3.72359970e-09],
       [-1.89733109e-09, -4.32207878e-09],
       [ 5.12426026e-09, -1.63696990e-09]]), array([1.62106655e-17, 2.22802302e-17, 2.89377136e-17]))
           fun: 1.6210665476880626e-17
       message: &#39;Optimization terminated successfully.&#39;
          nfev: 137
           nit: 73
        status: 0
       success: True
             x: array([-1.53149299e-09,  3.72359970e-09])
</pre></div>


<ul>
<li>Surface</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>x0 <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #555555">-</span><span style="color: #FF6600">0.25</span>,<span style="color: #FF6600">0.5</span>])]
res <span style="color: #555555">=</span> minimize(surface, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nelder-mead&#39;</span>,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #336666">True</span>})
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Optimization terminated successfully.
         Current function value: -0.380860
         Iterations: 76
         Function evaluations: 148
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>res
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span> final_simplex: (array([[-0.36266707,  1.17858233],
       [-0.36266707,  1.17858233],
       [-0.36266707,  1.17858233]]), array([-0.38086004, -0.38086004, -0.38086004]))
           fun: -0.3808600432413275
       message: &#39;Optimization terminated successfully.&#39;
          nfev: 148
           nit: 76
        status: 0
       success: True
             x: array([-0.36266707,  1.17858233])
</pre></div>


<h2 id="newtons-conjugate-gradient-method">Newton's Conjugate Gradient Method</h2>
<p>The minimum value of this function is 0 which is achieved when x =1</p>
<p><img alt="img" src="../img/0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen</span>(x):
    <span style="color: #CC3300; font-style: italic">&quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;</span>
    <span style="color: #006699; font-weight: bold">return</span> <span style="color: #336666">sum</span>(<span style="color: #FF6600">100.0</span><span style="color: #555555">*</span>(x[<span style="color: #FF6600">1</span>:]<span style="color: #555555">-</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span>)<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span> <span style="color: #555555">+</span> (<span style="color: #FF6600">1</span><span style="color: #555555">-</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span>)
</pre></div>


<p><img alt="img" src="../img/1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen_der</span>(x):
    xm <span style="color: #555555">=</span> x[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    xm_m1 <span style="color: #555555">=</span> x[:<span style="color: #555555">-</span><span style="color: #FF6600">2</span>]
    xm_p1 <span style="color: #555555">=</span> x[<span style="color: #FF6600">2</span>:]
    der <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros_like(x)
    der[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span><span style="color: #555555">*</span>(xm<span style="color: #555555">-</span>xm_m1<span style="color: #555555">**</span><span style="color: #FF6600">2</span>) <span style="color: #555555">-</span> <span style="color: #FF6600">400</span><span style="color: #555555">*</span>(xm_p1 <span style="color: #555555">-</span> xm<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)<span style="color: #555555">*</span>xm <span style="color: #555555">-</span> <span style="color: #FF6600">2</span><span style="color: #555555">*</span>(<span style="color: #FF6600">1</span><span style="color: #555555">-</span>xm)
    der[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">*</span>(x[<span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>) <span style="color: #555555">-</span> <span style="color: #FF6600">2</span><span style="color: #555555">*</span>(<span style="color: #FF6600">1</span><span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>])
    der[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span><span style="color: #555555">*</span>(x[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">return</span> der
</pre></div>


<p><img alt="img" src="../img/2.png" /></p>
<p><img alt="img" src="../img/3.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen_hess</span>(x):
    x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>asarray(x)
    H <span style="color: #555555">=</span> np<span style="color: #555555">.</span>diag(<span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>],<span style="color: #FF6600">1</span>) <span style="color: #555555">-</span> np<span style="color: #555555">.</span>diag(<span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>],<span style="color: #555555">-</span><span style="color: #FF6600">1</span>)
    diagonal <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros_like(x)
    diagonal[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">1200</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">+</span><span style="color: #FF6600">2</span>
    diagonal[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span>
    diagonal[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">202</span> <span style="color: #555555">+</span> <span style="color: #FF6600">1200</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span> <span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">2</span>:]
    H <span style="color: #555555">=</span> H <span style="color: #555555">+</span> np<span style="color: #555555">.</span>diag(diagonal)
    <span style="color: #006699; font-weight: bold">return</span> H
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>x0 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">1.3</span>, <span style="color: #FF6600">0.7</span>, <span style="color: #FF6600">0.8</span>, <span style="color: #FF6600">1.9</span>, <span style="color: #FF6600">1.2</span>])
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>res <span style="color: #555555">=</span> minimize(rosen, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;Newton-CG&#39;</span>,jac<span style="color: #555555">=</span>rosen_der, hess<span style="color: #555555">=</span>rosen_hess,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #336666">True</span>})
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 24
         Function evaluations: 33
         Gradient evaluations: 56
         Hessian evaluations: 24
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>res<span style="color: #555555">.</span>x
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>array([1.        , 1.        , 1.        , 0.99999999, 0.99999999])
</pre></div>


<hr />
<h3 id="references">References</h3>
<ol>
<li>https://andreask.cs.illinois.edu/cs357-s15/public/demos/12-optimization/Steepest%20Descent.html</li>
<li>https://scipy-lectures.org/advanced/mathematical_optimization/auto_examples/plot_gradient_descent.html</li>
<li>https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</li>
<li>https://scipy-cookbook.readthedocs.io/index.html</li>
<li>http://folk.ntnu.no/leifh/teaching/tkt4140/._main000.html</li>
</ol>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../SimulatedAnealing/simulatedAnn/" class="btn btn-neutral float-right" title="Simulated Annealing">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../../Montecarlo/BEC/bec/" class="btn btn-neutral" title="Bose-Einstein Condensation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../../Montecarlo/BEC/bec/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../SimulatedAnealing/simulatedAnn/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
