
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Optimization - Tutorials in Statistical Physics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scipy-optimization-source" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Tutorials in Statistical Physics" class="md-header-nav__button md-logo" aria-label="Tutorials in Statistical Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Tutorials in Statistical Physics
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Optimization
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Tutorials in Statistical Physics" class="md-nav__button md-logo" aria-label="Tutorials in Statistical Physics">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Tutorials in Statistical Physics
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../WhyComputationalPhysics/" class="md-nav__link">
      Why Computational Physics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/GettingStarted/intro/" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/GettingStarted/intro/" class="md-nav__link">
      Algorithms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/IdealGas/IdealGas/" class="md-nav__link">
      Ideal Gas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Oscillator/Oscillator/" class="md-nav__link">
      Harmonic Oscillator
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/IzingModel/Izing2D/" class="md-nav__link">
      Ising Model
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Percolation/percol/" class="md-nav__link">
      Percolation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/HardDisk/hd/" class="md-nav__link">
      Hard Disk
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/Levy/levy/" class="md-nav__link">
      Quantum Monte Carlo
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../Montecarlo/BEC/bec/" class="md-nav__link">
      Bose-Einstein Condensation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../SimulatedAnealing/simulatedAnn/" class="md-nav__link">
      Simulated Annealing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../PathIntegral/Intro/Intro/" class="md-nav__link">
      Path Integral
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../References/" class="md-nav__link">
      References
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scipy-optimization-source" class="md-nav__link">
    Scipy Optimization Source
  </a>
  
    <nav class="md-nav" aria-label="Scipy Optimization Source">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gradient-descient" class="md-nav__link">
    Gradient Descient
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-surfaces" class="md-nav__link">
    Plot Surfaces
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-concors" class="md-nav__link">
    Plot Concors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-minimum" class="md-nav__link">
    Find Minimum
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abritrary-surface-source" class="md-nav__link">
    Abritrary Surface source
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-surface" class="md-nav__link">
    Plot Surface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-contor" class="md-nav__link">
    Plot Contor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scipy-optimization" class="md-nav__link">
    Scipy Optimization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#newtons-conjugate-gradient-method" class="md-nav__link">
    Newton's Conjugate Gradient Method
  </a>
  
    <nav class="md-nav" aria-label="Newton's Conjugate Gradient Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Optimization</h1>
                
                <h2 id="scipy-optimization-source">Scipy Optimization <a href="https://docs.scipy.org/doc/scipy/reference/optimize.html#module-scipy.optimize">Source</a></h2>
<p>SciPy optimize provides functions for minimizing (or maximizing) objective functions, possibly subject to constraints. It includes solvers for nonlinear problems (with support for both local and global optimization algorithms), linear programing, constrained and nonlinear least-squares, root finding and curve fitting.</p>
<ol>
<li>Scalar Functions Optimization</li>
<li>Local (Multivariate) Optimization</li>
<li>Global Optimization</li>
<li>Least-squares and Curve Fitting</li>
<li>Root finding</li>
</ol>
<h3 id="gradient-descient">Gradient Descient</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy.linalg</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">la</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">scipy.optimize</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sopt</span>

<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">pt</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">mpl_toolkits.mplot3d</span> <span style="color: #006699; font-weight: bold">import</span> axes3d
<span style="color: #555555">%</span>matplotlib inline
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
sns<span style="color: #555555">.</span>set()
</code></pre></div>


<p>Spherical Surface : 
$$F(x,y) = x^{2} + y^{2}$$</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">sphere</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">df_sphere</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>], <span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]])
</code></pre></div>


<h3 id="plot-surfaces">Plot Surfaces</h3>
<ul>
<li>Sphere</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>fig <span style="color: #555555">=</span> pt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">8</span>,<span style="color: #FF6600">8</span>])
ax <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>gca(projection<span style="color: #555555">=</span><span style="color: #CC3300">&quot;3d&quot;</span>)

xmesh, ymesh <span style="color: #555555">=</span> np<span style="color: #555555">.</span>mgrid[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50</span>j,<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50</span>j]
fmesh <span style="color: #555555">=</span> sphere(np<span style="color: #555555">.</span>array([xmesh, ymesh]))
ax<span style="color: #555555">.</span>plot_surface(xmesh, ymesh, fmesh)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;mpl_toolkits.mplot3d.art3d.Poly3DCollection at 0x1a18961550&gt;
</code></pre></div>


<p><img alt="png" src="../output_9_1.png" /></p>
<h3 id="plot-concors">Plot Concors</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh,<span style="color: #FF6600">20</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.contour.QuadContourSet at 0x7f0bfe84f7b8&gt;
</code></pre></div>


<p><img alt="png" src="../output_11_1.png" /></p>
<h3 id="find-minimum">Find Minimum</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>guesses <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #FF6600">2</span>,<span style="color: #FF6600">2</span>])]
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">10000</span>):
    x <span style="color: #555555">=</span> guesses[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    s <span style="color: #555555">=</span> <span style="color: #555555">-</span>df_sphere(x)
    alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.001</span>

    next_guess <span style="color: #555555">=</span> x <span style="color: #555555">+</span> alpha <span style="color: #555555">*</span> s
    guesses<span style="color: #555555">.</span>append(next_guess)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>guesses[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">10</span>]
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>[array([2, 2]),
 array([1.996, 1.996]),
 array([1.992008, 1.992008]),
 array([1.98802398, 1.98802398]),
 array([1.98404794, 1.98404794]),
 array([1.98007984, 1.98007984]),
 array([1.97611968, 1.97611968]),
 array([1.97216744, 1.97216744]),
 array([1.96822311, 1.96822311]),
 array([1.96428666, 1.96428666])]
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh, <span style="color: #FF6600">10</span>)
it_array <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(guesses)
pt<span style="color: #555555">.</span>plot(it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">0</span>], it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">1</span>], <span style="color: #CC3300">&quot;o&quot;</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>[&lt;matplotlib.lines.Line2D at 0x7f0bfea38828&gt;]
</code></pre></div>


<p><img alt="png" src="../output_15_1.png" /></p>
<h3 id="abritrary-surface-source">Abritrary Surface <a href="https://en.wikipedia.org/wiki/Gradient_descent">source</a></h3>
<p><img alt="img" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/1ffee4fb42387d27e4a1e4d37d28239ff3b672fb" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">surface</span>(x):
    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span>np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))

<span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">df_surface</span>(x):

    u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)
    u_x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]
    u_y <span style="color: #555555">=</span> <span style="color: #555555">-</span>np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.25</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">+</span> <span style="color: #FF6600">3</span>)<span style="color: #555555">*</span><span style="color: #FF6600">0.5</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]

    v <span style="color: #555555">=</span> np<span style="color: #555555">.</span>cos(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))
    v_x <span style="color: #555555">=</span> <span style="color: #555555">-</span>np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))<span style="color: #555555">*</span><span style="color: #FF6600">2.0</span>
    v_y <span style="color: #555555">=</span> np<span style="color: #555555">.</span>sin(<span style="color: #FF6600">2.0</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.0</span> <span style="color: #555555">+</span> np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>]))<span style="color: #555555">*</span>np<span style="color: #555555">.</span>exp(x[<span style="color: #FF6600">1</span>])                                              

    df_x <span style="color: #555555">=</span> u_x<span style="color: #555555">*</span>v <span style="color: #555555">+</span> u<span style="color: #555555">*</span>v_x
    df_y <span style="color: #555555">=</span> u_y<span style="color: #555555">*</span>v <span style="color: #555555">+</span> u<span style="color: #555555">*</span>v_y

    <span style="color: #006699; font-weight: bold">return</span> np<span style="color: #555555">.</span>array([df_x,df_y])
</code></pre></div>


<h3 id="plot-surface">Plot Surface</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>fig <span style="color: #555555">=</span> pt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">8</span>,<span style="color: #FF6600">8</span>])
ax <span style="color: #555555">=</span> fig<span style="color: #555555">.</span>gca(projection<span style="color: #555555">=</span><span style="color: #CC3300">&quot;3d&quot;</span>)

xmesh, ymesh <span style="color: #555555">=</span> np<span style="color: #555555">.</span>mgrid[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50</span>j,<span style="color: #555555">-</span><span style="color: #FF6600">2</span>:<span style="color: #FF6600">2</span>:<span style="color: #FF6600">50</span>j]
fmesh <span style="color: #555555">=</span> surface(np<span style="color: #555555">.</span>array([xmesh, ymesh]))
ax<span style="color: #555555">.</span>plot_surface(xmesh, ymesh, fmesh)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;mpl_toolkits.mplot3d.art3d.Poly3DCollection at 0x7f0bfea68cc0&gt;
</code></pre></div>


<p><img alt="png" src="../output_20_1.png" /></p>
<h3 id="plot-contor">Plot Contor</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh,<span style="color: #FF6600">20</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.contour.QuadContourSet at 0x7f0bfeb2d390&gt;
</code></pre></div>


<p><img alt="png" src="../output_22_1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>guesses <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #555555">-</span><span style="color: #FF6600">0.25</span>,<span style="color: #FF6600">0.5</span>])]
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">100000</span>):
    x <span style="color: #555555">=</span> guesses[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    s <span style="color: #555555">=</span> <span style="color: #555555">-</span>df_surface(x)
    alpha <span style="color: #555555">=</span> <span style="color: #FF6600">0.0001</span>

    next_guess <span style="color: #555555">=</span> x <span style="color: #555555">+</span> alpha <span style="color: #555555">*</span> s
    guesses<span style="color: #555555">.</span>append(next_guess)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>guesses[<span style="color: #FF6600">0</span>:<span style="color: #FF6600">10</span>]
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>[array([-0.25,  0.5 ]),
 array([-0.24995774,  0.4999897 ]),
 array([-0.24991547,  0.49997941]),
 array([-0.24987321,  0.49996911]),
 array([-0.24983095,  0.49995882]),
 array([-0.24978869,  0.49994853]),
 array([-0.24974643,  0.49993824]),
 array([-0.24970417,  0.49992795]),
 array([-0.24966191,  0.49991766]),
 array([-0.24961965,  0.49990738])]
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>pt<span style="color: #555555">.</span>figure( figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])
pt<span style="color: #555555">.</span>axis(<span style="color: #CC3300">&quot;equal&quot;</span>)
pt<span style="color: #555555">.</span>contour(xmesh, ymesh, fmesh, <span style="color: #FF6600">10</span>)
it_array <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array(guesses)
pt<span style="color: #555555">.</span>plot(it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">0</span>], it_array<span style="color: #555555">.</span>T[<span style="color: #FF6600">1</span>], <span style="color: #CC3300">&quot;o&quot;</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>[&lt;matplotlib.lines.Line2D at 0x7f0bfdcb7e80&gt;]
</code></pre></div>


<p><img alt="png" src="../output_25_1.png" /></p>
<h3 id="scipy-optimization">Scipy Optimization</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">scipy.optimize</span> <span style="color: #006699; font-weight: bold">import</span> minimize
</code></pre></div>


<ul>
<li>Sphere</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>x0 <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #FF6600">5</span>,<span style="color: #FF6600">5</span>])]
res <span style="color: #555555">=</span> minimize(sphere, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nelder-mead&#39;</span>,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #006699; font-weight: bold">True</span>})
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 73
         Function evaluations: 137
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>res
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code> final_simplex: (array([[-1.53149299e-09,  3.72359970e-09],
       [-1.89733109e-09, -4.32207878e-09],
       [ 5.12426026e-09, -1.63696990e-09]]), array([1.62106655e-17, 2.22802302e-17, 2.89377136e-17]))
           fun: 1.6210665476880626e-17
       message: &#39;Optimization terminated successfully.&#39;
          nfev: 137
           nit: 73
        status: 0
       success: True
             x: array([-1.53149299e-09,  3.72359970e-09])
</code></pre></div>


<ul>
<li>Surface</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>x0 <span style="color: #555555">=</span> [np<span style="color: #555555">.</span>array([<span style="color: #555555">-</span><span style="color: #FF6600">0.25</span>,<span style="color: #FF6600">0.5</span>])]
res <span style="color: #555555">=</span> minimize(surface, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;nelder-mead&#39;</span>,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #006699; font-weight: bold">True</span>})
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Optimization terminated successfully.
         Current function value: -0.380860
         Iterations: 76
         Function evaluations: 148
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>res
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code> final_simplex: (array([[-0.36266707,  1.17858233],
       [-0.36266707,  1.17858233],
       [-0.36266707,  1.17858233]]), array([-0.38086004, -0.38086004, -0.38086004]))
           fun: -0.3808600432413275
       message: &#39;Optimization terminated successfully.&#39;
          nfev: 148
           nit: 76
        status: 0
       success: True
             x: array([-0.36266707,  1.17858233])
</code></pre></div>


<h2 id="newtons-conjugate-gradient-method">Newton's Conjugate Gradient Method</h2>
<p>The minimum value of this function is 0 which is achieved when x =1</p>
<p><img alt="img" src="../img/0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen</span>(x):
    <span style="color: #CC3300; font-style: italic">&quot;&quot;&quot;The Rosenbrock function&quot;&quot;&quot;</span>
    <span style="color: #006699; font-weight: bold">return</span> <span style="color: #336666">sum</span>(<span style="color: #FF6600">100.0</span><span style="color: #555555">*</span>(x[<span style="color: #FF6600">1</span>:]<span style="color: #555555">-</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span>)<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span> <span style="color: #555555">+</span> (<span style="color: #FF6600">1</span><span style="color: #555555">-</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>])<span style="color: #555555">**</span><span style="color: #FF6600">2.0</span>)
</code></pre></div>


<p><img alt="img" src="../img/1.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen_der</span>(x):
    xm <span style="color: #555555">=</span> x[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
    xm_m1 <span style="color: #555555">=</span> x[:<span style="color: #555555">-</span><span style="color: #FF6600">2</span>]
    xm_p1 <span style="color: #555555">=</span> x[<span style="color: #FF6600">2</span>:]
    der <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros_like(x)
    der[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span><span style="color: #555555">*</span>(xm<span style="color: #555555">-</span>xm_m1<span style="color: #555555">**</span><span style="color: #FF6600">2</span>) <span style="color: #555555">-</span> <span style="color: #FF6600">400</span><span style="color: #555555">*</span>(xm_p1 <span style="color: #555555">-</span> xm<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)<span style="color: #555555">*</span>xm <span style="color: #555555">-</span> <span style="color: #FF6600">2</span><span style="color: #555555">*</span>(<span style="color: #FF6600">1</span><span style="color: #555555">-</span>xm)
    der[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">*</span>(x[<span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>) <span style="color: #555555">-</span> <span style="color: #FF6600">2</span><span style="color: #555555">*</span>(<span style="color: #FF6600">1</span><span style="color: #555555">-</span>x[<span style="color: #FF6600">0</span>])
    der[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span><span style="color: #555555">*</span>(x[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">-</span>x[<span style="color: #555555">-</span><span style="color: #FF6600">2</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span>)
    <span style="color: #006699; font-weight: bold">return</span> der
</code></pre></div>


<p><img alt="img" src="../img/2.png" /></p>
<p><img alt="img" src="../img/3.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">rosen_hess</span>(x):
    x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>asarray(x)
    H <span style="color: #555555">=</span> np<span style="color: #555555">.</span>diag(<span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>],<span style="color: #FF6600">1</span>) <span style="color: #555555">-</span> np<span style="color: #555555">.</span>diag(<span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>],<span style="color: #555555">-</span><span style="color: #FF6600">1</span>)
    diagonal <span style="color: #555555">=</span> np<span style="color: #555555">.</span>zeros_like(x)
    diagonal[<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">1200</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">0</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span><span style="color: #555555">-</span><span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>]<span style="color: #555555">+</span><span style="color: #FF6600">2</span>
    diagonal[<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">200</span>
    diagonal[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">202</span> <span style="color: #555555">+</span> <span style="color: #FF6600">1200</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">1</span>:<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">**</span><span style="color: #FF6600">2</span> <span style="color: #555555">-</span> <span style="color: #FF6600">400</span><span style="color: #555555">*</span>x[<span style="color: #FF6600">2</span>:]
    H <span style="color: #555555">=</span> H <span style="color: #555555">+</span> np<span style="color: #555555">.</span>diag(diagonal)
    <span style="color: #006699; font-weight: bold">return</span> H
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>x0 <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">1.3</span>, <span style="color: #FF6600">0.7</span>, <span style="color: #FF6600">0.8</span>, <span style="color: #FF6600">1.9</span>, <span style="color: #FF6600">1.2</span>])
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>res <span style="color: #555555">=</span> minimize(rosen, x0, method<span style="color: #555555">=</span><span style="color: #CC3300">&#39;Newton-CG&#39;</span>,jac<span style="color: #555555">=</span>rosen_der, hess<span style="color: #555555">=</span>rosen_hess,
                options<span style="color: #555555">=</span>{<span style="color: #CC3300">&#39;xtol&#39;</span>: <span style="color: #FF6600">1e-8</span>, <span style="color: #CC3300">&#39;disp&#39;</span>: <span style="color: #006699; font-weight: bold">True</span>})
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Optimization terminated successfully.
         Current function value: 0.000000
         Iterations: 24
         Function evaluations: 33
         Gradient evaluations: 56
         Hessian evaluations: 24
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>res<span style="color: #555555">.</span>x
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>array([1.        , 1.        , 1.        , 0.99999999, 0.99999999])
</code></pre></div>


<hr />
<h3 id="references">References</h3>
<ol>
<li>https://andreask.cs.illinois.edu/cs357-s15/public/demos/12-optimization/Steepest%20Descent.html</li>
<li>https://scipy-lectures.org/advanced/mathematical_optimization/auto_examples/plot_gradient_descent.html</li>
<li>https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</li>
<li>https://scipy-cookbook.readthedocs.io/index.html</li>
<li>http://folk.ntnu.no/leifh/teaching/tkt4140/._main000.html</li>
</ol>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>